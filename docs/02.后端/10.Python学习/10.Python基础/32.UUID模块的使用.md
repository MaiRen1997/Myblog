`UUID` 模块用于生成 **通用唯一标识符**（Universally Unique Identifier），是 Python 标准库的一部分

## 基本用法

```python
import uuid

# 生成一个随机的 UUID
uuid_obj = uuid.uuid4()
print(uuid_obj)                    # f47ac10b-58cc-4372-a567-0e02b2c3d479
print(type(uuid_obj))              # <class 'uuid.UUID'>
print(str(uuid_obj))               # 'f47ac10b-58cc-4372-a567-0e02b2c3d479'
```

## 五种 UUID 生成方法

### **UUID1** - 基于时间戳和 MAC 地址

```python
# 基于主机ID、序列号和当前时间生成
uuid1 = uuid.uuid1()
print(f"UUID1: {uuid1}")
print(f"版本: {uuid1.version}")      # 1
print(f"MAC地址部分: {uuid1.node}")  # 48位MAC地址
```

### **UUID3** - 基于 MD5 和命名空间

```python
# 需要提供命名空间和名称
namespace_dns = uuid.NAMESPACE_DNS
uuid3 = uuid.uuid3(namespace_dns, 'example.com')
print(f"UUID3: {uuid3}")            # 每次相同输入生成相同UUID
print(f"版本: {uuid3.version}")      # 3
```

### **UUID4** - 随机生成（最常用）

```python
# 完全随机生成，最常用
uuid4 = uuid.uuid4()
print(f"UUID4: {uuid4}")
print(f"版本: {uuid4.version}")      # 4
```

### **UUID5** - 基于 SHA-1 和命名空间

```python
# 类似于UUID3，但使用SHA-1
namespace_url = uuid.NAMESPACE_URL
uuid5 = uuid.uuid5(namespace_url, 'https://example.com')
print(f"UUID5: {uuid5}")
print(f"版本: {uuid5.version}")      # 5
```

### **UUID2** - 基于 DCE 安全

```python
# 在Python中一般不实现，与平台相关
# uuid.uuid2()  # 通常不可用
```

## UUID 对象的属性和方法

```python
uid = uuid.uuid4()

# 访问属性
print(f"bytes: {uid.bytes}")          # 16字节表示
print(f"int: {uid.int}")              # 128位整数
print(f"hex: {uid.hex}")              # 32字符十六进制
print(f"urn: {uid.urn}")              # URN格式
print(f"variant: {uid.variant}")      # UUID变体
print(f"version: {uid.version}")      # UUID版本

# 转换为不同格式
print(f"字符串: {str(uid)}")
print(f"十六进制: {uid.hex}")
print(f"整数: {uid.int}")
print(f"字节: {uid.bytes}")
```

## 常用命名空间常量

```python
print(uuid.NAMESPACE_DNS)    # 用于DNS的UUID
print(uuid.NAMESPACE_URL)    # 用于URL的UUID
print(uuid.NAMESPACE_OID)    # 用于ISO OID的UUID
print(uuid.NAMESPACE_X500)   # 用于X.500 DN的UUID
```

## 实际应用场景

### **生成唯一文件名**

```python
import uuid
import os

filename = f"{uuid.uuid4()}.jpg"
print(f"唯一文件名: {filename}")  # 如: 3b9d6b7f-5c3d-4e1a-8b2c-9e8f7a6b5c4d.jpg
```

### **数据库主键**

```python
import uuid
import sqlite3

# 创建带UUID主键的用户表
user_id = uuid.uuid4()
print(f"用户ID: {user_id}")
```

### **会话标识**

```python
session_id = str(uuid.uuid4())
print(f"会话ID: {session_id}")
```

### **批量生成UUID**

```python
# 生成多个UUID
uuids = [str(uuid.uuid4()) for _ in range(5)]
for u in uuids:
    print(u)
```

## 字符串和 UUID 对象的转换

```python
# 字符串转UUID对象
uuid_str = "12345678-1234-5678-1234-567812345678"
uuid_obj = uuid.UUID(uuid_str)
print(uuid_obj)

# 十六进制转UUID
hex_str = "12345678123456781234567812345678"
uuid_from_hex = uuid.UUID(hex=hex_str)
print(uuid_from_hex)

# 整数转UUID
int_val = 123456789012345678901234567890123456789
uuid_from_int = uuid.UUID(int=int_val)
print(uuid_from_int)
```

## 验证和比较 UUID

```python
# 验证UUID格式
def is_valid_uuid(uuid_string):
    try:
        uuid_obj = uuid.UUID(uuid_string)
        return str(uuid_obj) == uuid_string
    except ValueError:
        return False

# 测试
test_ids = [
    "12345678-1234-5678-1234-567812345678",  # 有效
    "invalid-uuid-string",                    # 无效
    str(uuid.uuid4())                         # 有效
]

for test_id in test_ids:
    print(f"{test_id}: {is_valid_uuid(test_id)}")

# 比较UUID
uid1 = uuid.uuid4()
uid2 = uuid.uuid4()
uid3 = uuid.UUID(str(uid1))  # 相同值的不同对象

print(f"uid1 == uid2: {uid1 == uid2}")  # False
print(f"uid1 == uid3: {uid1 == uid3}")  # True (值相同)
print(f"uid1 is uid3: {uid1 is uid3}")  # False (不是同一个对象)
```

## 实际项目中的封装使用

```python
import uuid
from typing import Optional

class UUIDGenerator:
    """UUID生成工具类"""
    
    @staticmethod
    def generate_uuid4() -> str:
        """生成UUID4字符串"""
        return str(uuid.uuid4())
    
    @staticmethod
    def generate_uuid1() -> str:
        """生成UUID1字符串（包含时间信息）"""
        return str(uuid.uuid1())
    
    @staticmethod
    def generate_uuid5(name: str, namespace: uuid.UUID = uuid.NAMESPACE_DNS) -> str:
        """生成UUID5（基于名称）"""
        return str(uuid.uuid5(namespace, name))
    
    @staticmethod
    def is_valid(uuid_str: str) -> bool:
        """验证UUID格式"""
        try:
            uuid.UUID(uuid_str)
            return True
        except ValueError:
            return False
    
    @staticmethod
    def short_uuid(length: int = 8) -> str:
        """生成短UUID（前N位）"""
        full_uuid = uuid.uuid4().hex
        return full_uuid[:length]

# 使用示例
if __name__ == "__main__":
    generator = UUIDGenerator()
    
    # 生成各种UUID
    print(f"UUID4: {generator.generate_uuid4()}")
    print(f"UUID1: {generator.generate_uuid1()}")
    print(f"UUID5: {generator.generate_uuid5('example.com')}")
    print(f"短UUID: {generator.short_uuid(8)}")
    
    # 验证
    test_uuid = generator.generate_uuid4()
    print(f"验证 {test_uuid}: {generator.is_valid(test_uuid)}")
```

## 性能和安全考虑

```python
import uuid
import time

# 性能测试
start = time.time()
for _ in range(10000):
    uuid.uuid4()
end = time.time()
print(f"生成10000个UUID耗时: {end - start:.2f}秒")

# 安全性：UUID4是随机生成的，足够安全
# 但对于极高安全要求，可以使用：
import secrets
secure_uuid = uuid.UUID(bytes=secrets.token_bytes(16))
print(f"加密安全的UUID: {secure_uuid}")
```











