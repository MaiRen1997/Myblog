## 基础语法

### 基本格式

1. 字符串拼接

2. 直接在print使用

3. ```python
   name = "Alice"
   age = 25
   
   # 基本用法
   message = f"My name is {name} and I'm {age} years old."
   print(message)  # My name is Alice and I'm 25 years old
   
   # 在 print 中直接使用
   print(f"Hello, {name}!")
   ```

### 单、双引号与多行

1. 单行字符串，可以使用单引号或双引号

2. 多行字符串使用三引号

3. ```python
   # 单引号
   f'Name: {name}'
   
   # 双引号
   f"Name: {name}"
   
   # 三引号（多行字符串）
   message = f"""
   User Information:
     Name: {name}
     Age: {age}
   """
   print(message)
   ```

## 变量和表达式

### 使用表达式

1. print内使用表达式

2. ```go
   x = 10
   y = 20
   print(f"x + y = {x + y}")      # x + y = 30
   print(f"x * y = {x * y}")      # x * y = 200
   print(f"x^2 = {x ** 2}")       # x^2 = 100
   ```

### 调用函数和方法

```python
name = "python"
print(f"Uppercase: {name.upper()}")          # UPPERCASE: PYTHON
print(f"Capitalize: {name.capitalize()}")    # Capitalize: Python
print(f"Length: {len(name)}")                # Length: 6

import math
print(f"π = {math.pi:.3f}")                  # π = 3.142
print(f"√2 = {math.sqrt(2):.4f}")            # √2 = 1.4142
```

### 复杂表达式

```python
# 列表操作
items = ['apple', 'banana', 'cherry']
print(f"First item: {items[0]}")             # First item: apple
print(f"Last item: {items[-1]}")             # Last item: cherry
print(f"Items count: {len(items)}")          # Items count: 3

# 字典操作
person = {'name': 'Bob', 'age': 30}
print(f"Name: {person['name']}")             # Name: Bob
print(f"Age: {person.get('age')}")           # Age: 30

# 条件表达式
score = 85
print(f"Grade: {'Pass' if score >= 60 else 'Fail'}")  # Grade: Pass
```

## 格式说明符

### 小数格式化

```python
num = 123.456789

# 小数位数
print(f"{num:.2f}")      # 123.46
print(f"{num:.0f}")      # 123
print(f"{num:.4f}")      # 123.4568

# 宽度和对齐
print(f"{num:10.2f}")    # '    123.46' - 总宽度10
print(f"{num:<10.2f}")   # '123.46    ' - 左对齐
print(f"{num:>10.2f}")   # '    123.46' - 右对齐
print(f"{num:^10.2f}")   # '  123.46  ' - 居中对齐

# 填充字符
print(f"{num:*>10.2f}")  # ****123.46
print(f"{num:=^10.2f}")  # ==123.46==
```

### 整数格式化

```python
n = 42

# 进制转换
print(f"Decimal: {n}")       # 42
print(f"Binary: {n:b}")      # 101010
print(f"Octal: {n:o}")       # 52
print(f"Hex (lower): {n:x}") # 2a
print(f"Hex (upper): {n:X}") # 2A

# 带前缀
print(f"Hex with 0x: {n:#x}")   # 0x2a
print(f"Binary with 0b: {n:#b}") # 0b101010

# 宽度和前导0
print(f"{n:04d}")    # 0042
print(f"{n:08b}")    # 00101010
```

### 字符串格式化

```python
text = "hello"

# 对齐
print(f"|{text:<10}|")    # |hello     |
print(f"|{text:>10}|")    # |     hello|
print(f"|{text:^10}|")    # |  hello   |

# 填充
print(f"{text:*<10}")     # hello*****
print(f"{text:*>10}")     # *****hello
print(f"{text:*^10}")     # **hello***

# 截断
long_text = "Hello, World!"
print(f"{long_text:.5}")  # Hello
```

### 特殊格式

```python
# 千位分隔符
big_num = 1234567.89
print(f"{big_num:,}")           # 1,234,567.89
print(f"{big_num:,.2f}")        # 1,234,567.89

# 百分比
ratio = 0.756
print(f"{ratio:.1%}")           # 75.6%
print(f"{ratio:.2%}")           # 75.60%

# 科学计数法
small_num = 0.000123456
print(f"{small_num:.2e}")       # 1.23e-04
print(f"{small_num:.4E}")       # 1.2346E-04

# 正负号显示
temp = -5
print(f"{temp:+}°C")            # -5°C
temp = 20
print(f"{temp:+}°C")            # +20°C
```

## 高级用法

### 嵌套花括号

```python
# 显示花括号本身
print(f"{{This is in braces}}")      # {This is in braces}

# 嵌套格式化
width = 10
precision = 2
value = 12.34567
print(f"{value:{width}.{precision}f}")  # '     12.35'
```

### 时间日期格式化

```python
from datetime import datetime

now = datetime.now()
print(f"Date: {now:%Y-%m-%d}")        # Date: 2024-01-15
print(f"Time: {now:%H:%M:%S}")        # Time: 14:30:45
print(f"Full: {now:%Y-%m-%d %H:%M:%S}")  # Full: 2024-01-15 14:30:45

# 常用格式
print(f"{now:%A, %B %d, %Y}")        # Monday, January 15, 2024
print(f"{now:%I:%M %p}")             # 02:30 PM
```

### 调用自定义函数

```python
def get_greeting(name):
    return f"Hello, {name}!"

name = "Alice"
print(f"{get_greeting(name)}")       # Hello, Alice!

# 直接在 f-string 中调用
print(f"{'python'.upper()}")         # PYTHON
```

### 调试输出(python3.8+)

```python
x = 10
y = 20

# 使用 = 可以同时显示变量名和值
print(f"{x=}, {y=}")                 # x=10, y=20
print(f"{x + y = }")                 # x + y = 30
print(f"{x * y = :,}")               # x * y = 200

# 在表达式中使用
data = [1, 2, 3, 4, 5]
print(f"{len(data) = }")             # len(data) = 5
print(f"{sum(data) = }")             # sum(data) = 15
```

## 实用示例

### 表格输出

```python
employees = [
    ("Alice", "Engineering", 75000, 85.5),
    ("Bob", "Marketing", 65000, 92.3),
    ("Charlie", "Sales", 82000, 78.9),
    ("Diana", "HR", 58000, 95.1)
]

# 表头
print(f"{'Name':<10} {'Department':<15} {'Salary':>10} {'Score':>8}")
print("-" * 50)

# 数据行
for name, dept, salary, score in employees:
    print(f"{name:<10} {dept:<15} ${salary:>9,} {score:>7.1f}%")

# 输出：
# Name       Department       Salary   Score
# --------------------------------------------------
# Alice      Engineering      $75,000    85.5%
# Bob        Marketing        $65,000    92.3%
# Charlie    Sales            $82,000    78.9%
# Diana      HR               $58,000    95.1%
```

### 进度条显示

```python
def show_progress(current, total):
    percent = (current / total) * 100
    bar_length = 30
    filled_length = int(bar_length * current // total)
    bar = '█' * filled_length + '-' * (bar_length - filled_length)
    
    print(f"\rProgress: |{bar}| {percent:.1f}% ({current}/{total})", end='')

# 使用示例
import time
total = 100
for i in range(total + 1):
    show_progress(i, total)
    time.sleep(0.05)
print()  # 换行
```

### 数据报告

```python
data = {
    'revenue': 1500000,
    'expenses': 850000,
    'profit': 650000,
    'growth_rate': 0.15
}

print("Financial Report")
print("=" * 40)
print(f"Revenue:      ${data['revenue']:>13,}")
print(f"Expenses:     ${data['expenses']:>13,}")
print(f"Profit:       ${data['profit']:>13,}")
print(f"Growth Rate:  {data['growth_rate']:>13.1%}")
print("=" * 40)

# 输出：
# Financial Report
# ========================================
# Revenue:      $  1,500,000
# Expenses:     $    850,000
# Profit:       $    650,000
# Growth Rate:           15.0%
```

### 数学公式显示

```python
import math

a, b = 3, 4
c = math.sqrt(a**2 + b**2)

print(f"Pythagorean Theorem:")
print(f"a = {a}, b = {b}")
print(f"c = √({a}² + {b}²) = √({a**2} + {b**2}) = √{a**2 + b**2} = {c:.2f}")
```

## 注意事项和技巧

### 转义字符

```python
# 不能在 f-string 中使用反斜杠转义
# 错误：print(f"{\n}")  # SyntaxError

# 正确做法：
print(f"{{newline}}")  # 显示 {newline}
newline = "\n"
print(f"Line1{newline}Line2")  # 使用变量
```

### 性能考虑

```python
import timeit

# f-string 最快
code1 = '''
name = "Alice"
age = 25
f"My name is {name} and I'm {age} years old."
'''

code2 = '''
name = "Alice"
age = 25
"My name is {} and I'm {} years old.".format(name, age)
'''

code3 = '''
name = "Alice"
age = 25
"My name is %s and I'm %d years old." % (name, age)
'''

print("f-string:", timeit.timeit(code1, number=1000000))
print("format():", timeit.timeit(code2, number=1000000))
print("% format:", timeit.timeit(code3, number=1000000))
```

### 复杂表达式分行

```python
# 使用括号多行编写
result = (
    f"Detailed Analysis:\n"
    f"  Total Items: {len(items)}\n"
    f"  Average: {sum(items)/len(items):.2f}\n"
    f"  Max: {max(items)}\n"
    f"  Min: {min(items)}"
)
```

### 条件格式化

```python
temperature = 25
status = "normal"

print(f"Temperature: {temperature}°C - Status: {status}")

# 根据条件改变颜色（终端中显示）
color = "\033[91m" if temperature > 30 else "\033[92m"  # 红色或绿色
reset = "\033[0m"
print(f"Temperature: {color}{temperature}°C{reset}")
```

















