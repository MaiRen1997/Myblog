---
title: Field的使用
date: 2026-01-26 13:47:38
permalink: /pages/0d3925/
categories:
  - 后端
  - Python学习
  - 第三方库的使用
  - Pydantic的使用
tags:
  - 
author: 
  name: Riverside Joy
  link: https://github.com/MaiRen1997
---
## 参数

### 验证约束参数

#### 数值参数

```python
# 数值类型约束
number: int = Field(
    gt=0,        # 大于0 (greater than)
    ge=1,        # 大于等于1 (greater than or equal)
    lt=100,      # 小于100 (less than)
    le=99,       # 小于等于99 (less than or equal)
    multiple_of=5,  # 5的倍数
)
```

#### 字符串约束

```python
# 字符串类型约束
text: str = Field(
    min_length=1,     # 最小长度
    max_length=100,   # 最大长度
    pattern=r'^\w+$', # 正则表达式
    strip_whitespace=True,  # 去除首尾空白
)
```

#### 集合约束

```python
# 列表/集合约束
items: list[str] = Field(
    min_length=1,      # 最小元素数量
    max_length=10,     # 最大元素数量
)
```

### 默认值参数

```python
# 默认值设置
value: int = Field(
    default=10,              # 简单默认值
    default_factory=list,    # 工厂函数生成默认值
)
```

### 别名与序列化控制

```python
# 别名配置
user_data: dict = Field(
    alias="userData",        # 输入时的别名（蛇形转驼峰）
    validation_alias="user_data",  # 验证时的别名
    serialization_alias="userData",  # 序列化时的别名
    title="用户数据",         # 字段标题
    description="用户信息字典",  # 字段描述
)
```

### 序列化行为控制

```python
# 序列化控制
password: str = Field(
    exclude=True,           # 从序列化输出中排除
    include_in_schema=False,  # 不在OpenAPI文档中显示
    repr=True,              # 是否在__repr__中显示
    init=True,              # 是否包含在__init__参数中
    init_var=True,          # 是否作为初始化变量
    kw_only=True,          # 必须是关键字参数
)
```

### 文档与元数据

```python
# 文档和示例
config: dict = Field(
    title="配置信息",
    description="系统配置参数",
    examples=[{"key": "value"}],  # 示例值
    json_schema_extra={
        "deprecated": False,
        "notes": "额外说明"
    },
)
```

### 高级验证

```python
# 高级验证参数
from pydantic import field_validator

items: list[int] = Field(
    validate_default=True,    # 验证默认值
    strict=True,              # 严格模式（禁止类型转换）
    json_schema_serialization_default=None,  # JSON Schema中的默认
)
```

### 错误信息定制

```python
# 错误消息定制
age: int = Field(
    ge=18,
    le=100,
    error_messages={
        "ge": "年龄必须大于等于18岁",
        "le": "年龄不能超过100岁",
        "type": "年龄必须是整数",
    },
)
```

### 完整示例

```python
from pydantic import BaseModel, Field
from typing import Optional, List
from datetime import datetime

class User(BaseModel):
    # 必填字段
    username: str = Field(
        min_length=3,
        max_length=20,
        pattern=r'^[a-zA-Z0-9_]+$',
        description="用户名，3-20位字母数字下划线",
        examples=["john_doe", "alice123"],
        error_messages={
            "min_length": "用户名至少3个字符",
            "pattern": "只能包含字母、数字和下划线"
        }
    )
    
    # 可选字段
    email: Optional[str] = Field(
        default=None,
        pattern=r'^[\w\.-]+@[\w\.-]+\.\w+$',
        description="用户邮箱",
        alias="userEmail",
        title="邮箱地址"
    )
    
    # 敏感字段
    password_hash: str = Field(
        exclude=True,  # 序列化时排除
        repr=False,    # 不显示在repr中
        min_length=8,
        description="密码哈希值"
    )
    
    # 数值字段
    age: int = Field(
        ge=0,
        le=150,
        default=0,
        description="用户年龄",
        json_schema_extra={"unit": "years"}
    )
    
    # 列表字段
    tags: List[str] = Field(
        default_factory=list,
        min_length=0,
        max_length=10,
        description="用户标签"
    )
    
    # 时间字段
    created_at: datetime = Field(
        default_factory=datetime.now,
        description="创建时间",
        alias="createdAt"
    )
    
    # 配置字段
    settings: dict = Field(
        default_factory=dict,
        description="用户设置",
        json_schema_serialization_default={}
    )
```

## 使用示例

### 提供字段验证约束

```python
from pydantic import BaseModel, Field
from typing import Optional

class User(BaseModel):
    age: int = Field(ge=18, le=120)  # 年龄必须在18-120之间
    name: str = Field(min_length=1, max_length=50)  # 姓名长度限制
    email: str = Field(pattern=r'^[\w\.-]+@[\w\.-]+\.\w+$')  # 正则验证
    score: float = Field(gt=0, lt=100)  # 大于0小于100
```

### 设置默认值

```python
class Config(BaseModel):
    timeout: int = Field(default=30)
    retries: int = Field(default=3)
    enabled: bool = Field(default=True)
```

### 添加字段描述文档

```python
class Product(BaseModel):
    price: float = Field(
        description="产品价格，单位为元",
        gt=0,
        examples=[99.99, 199.99]
    )
    stock: int = Field(
        description="库存数量",
        ge=0,
        example=100
    )
```

### 配置序列化行为

```python
class User(BaseModel):
    username: str
    password: str = Field(exclude=True)  # 序列化时排除密码字段
    sensitive_data: str = Field(repr=False)  # 不显示在__repr__中
    
    # 别名设置
    first_name: str = Field(alias="firstName")
    last_name: str = Field(alias="lastName")
```

### 更多实用功能

```python
class Data(BaseModel):
    # 必填字段验证
    required_field: str = Field(..., min_length=1)  # ... 表示必填
    
    # 使用函数验证
    items: list[str] = Field(
        min_length=1,
        description="至少包含一个项目"
    )
    
    # 自定义错误信息
    age: int = Field(
        ge=18,
        le=100,
        description="用户年龄",
        error_messages={
            "ge": "年龄必须大于等于18岁",
            "le": "年龄不能超过100岁"
        }
    )
    
    # 元数据
    version: str = Field(
        default="1.0",
        title="API版本",
        json_schema_extra={
            "deprecated": False,
            "notes": "当前API版本号"
        }
    )
```

### 实际使用示例

```python
from datetime import datetime
from typing import List

class Article(BaseModel):
    id: int = Field(gt=0, description="文章ID")
    title: str = Field(
        min_length=1,
        max_length=200,
        description="文章标题"
    )
    content: str = Field(min_length=1, description="文章内容")
    tags: List[str] = Field(
        default_factory=list,
        max_items=10,
        description="标签列表"
    )
    views: int = Field(
        default=0,
        ge=0,
        description="阅读次数"
    )
    created_at: datetime = Field(
        default_factory=datetime.now,
        description="创建时间"
    )
    is_published: bool = Field(
        default=False,
        alias="isPublished",
        description="是否已发布"
    )
```