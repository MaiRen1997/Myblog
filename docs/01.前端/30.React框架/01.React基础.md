---
title: React基础
date: 2023-12-19 13:51:49
permalink: /pages/e04516/
author: Riverside Joy
categories:
  - 前端
  - React框架
tags:
  - 
---
## 创建项目

### 安装create-react-app

```sh
$ npm install -g create-react-app
```

###  创建项目

```sh
$ create-react-app your-app #注意命名方式
```

> tips:
>
> - 默认创建的是js项目，如果需要使用ts项目，可以加上template
>
>   ```sh
>   $ create-react-app your-app -template typescript
>   ```
>
> - 如果不想全局安装，可以使用npx
>
>   ```sh
>   $ npx create-react-app your-app	也可以实现相同的效果
>   ```
>
>   
>
> 

## 使用yarn

- 安装 npm install -g yarn
- 查看版本 yarn --version
- 查看镜像 yarn config get registry
- 设置淘宝源 yarn config set registry https://registry.npm.taobao.org -g
- 安装依赖 yarn add 包名

## React的特点和优势

**(1) 虚拟DOM**

我们以前操作dom的方式是通过document.getElementById()的方式，这样的过程实际上是先去读取html的dom结构，将结构转换成变量，再进行操作。而reactjs定义了一套变量形式的dom模型，一切操作和换算直接在变量中，这样减少了操作真实dom，性能真实相当的高，和主流MVC框架有本质的区别，并不和dom打交道

**(2) 组件系统**

react最核心的思想是将页面中任何一个区域或者元素都可以看做一个组件 component

那么什么是组件呢？

组件指的就是同时包含了html、css、js、image元素的聚合体

使用react开发的核心就是将页面拆分成若干个组件，并且react一个组件中同时耦合了css、js、image，这种模式整个颠覆了过去的传统的方式

**(3) 单向数据流**

其实reactjs的核心内容就是数据绑定，所谓数据绑定指的是只要将一些服务端的数据和前端页面绑定好，开发者只关注实现业务就行了

**(4) JSX  语法**

在vue中，我们使用render函数来构建组件的dom结构性能较高，因为省去了查找和编译模板的过程，但是在render中利用createElement创建结构的时候代码可读性较低，较为复杂，此时可以利用jsx语法来在render中创建dom，解决这个问题，但是前提是需要使用工具来编译jsx

## diff算法

1. 什么是diff算法

   diff算法是`调和的具体实现`

2. 什么是调和

   将Virtual Dom 树转换成actual DOM树的`最少操作的过程`，称为调和

3. diff算法的作用

   - 计算出Virtual DOM中真正变化的部分
   - 并只对该部分进行原生DOM操作，而非重新渲染整个页面

4. diff策略

   1. 同级比较

      Web UI 中DOM节点跨层级的移动操作特别少，可以忽略不计

   2. 组件策略

      - 拥有相同类的两个组件，生成相似的树形结构
      - 拥有不同类的两个组件，生成不同的树形结构

   3. key比较

      对于同一层级的一组子节点，通过唯一id区分

5. 上述组件策略分类

   1. 同一类型的两个组件，按原策略(层级比较)继续比较Virtual DOM树即可
   2. 同一类型的两个组件，组件A变化为组件B时，可能Virtual Dom没有任何变化。用户可以通过shouldComponentUpdate()来判断是否需要 更新
   3. 不同类型的组件，将一个(将被改变的)组件判断为dirty component(脏组件)，从而替换整个组件的所有节点


## 简单的react代码

```tsx
// 从 react 的包当中引入了 React。只要你要写 React.js 组件就必须引入React, 因为react里有一种语法叫JSX，稍后会讲到JSX，要写JSX，就必须引入React
import React from 'react'
// ReactDOM 可以帮助我们把 React 组件渲染到页面上去，没有其它的作用了。它是从 react-dom 中引入的，而不是从 react 引入。
import ReactDOM from 'react-dom'

// ReactDOM里有一个render方法，功能就是把组件渲染并且构造 DOM 树，然后插入到页面上某个特定的元素上
ReactDOM.render(
// 这里就比较奇怪了，它并不是一个字符串，看起来像是纯 HTML 代码写在 JavaScript 代码里面。语法错误吗？这并不是合法的 JavaScript 代码, “在 JavaScript 写的标签的”语法叫 JSX- JavaScript XML。
  <h1>欢迎进入React的世界</h1>,
// 渲染到哪里
  document.getElementById('root')
)
```

## react元素与组件

> react-dom在整个项目中，只需要在index.tsx中引入一次就够了，其他地方不需要引入

### 区别

在react中，大小写敏感，大写的为组件名称，小写的为标签元素

1. 组件

   ```tsx
   import React from 'react';
   import ReactDOM from 'react-dom';
   const app = <div>hello react</div> // 注意这里的定义方式(以纯html定义，无法使用函数定义)
   ReactDOM.render(
     app,
     document.getElementById('root')
   );
   ```

2. 元素

   ```tsx
   import React from 'react';
   import ReactDOM from 'react-dom';
   const App = () => <div>hello react</div> // 注意这里的定义方式(以函数的形式定义)
   ReactDOM.render(
     <App />,
     document.getElementById('root')
   );
   ```


### 组件传参

#### 函数组件传参

> JSX中，变量使用大括号进行识别、使用
>
> 在 { } 可以直接写js语句

##### 传单个参数

可以直接使用prop接收

```tsx
import ReactDOM from 'react-dom';
const app =(prop: any) => <div>hello react!{prop}</div>
ReactDOM.render(
  app('test'),
  document.getElementById('root')
);
```

##### 传多个参数

可以使用对象或者数据等复杂类型传参

```tsx
import React from 'react';
import ReactDOM from 'react-dom';
const app =(prop: any) => <div>my name is {prop.name}, I'm {prop.age} age</div>
ReactDOM.render(
  app({name: 'riverside joy', age: 8}), // 使用对象传参
  document.getElementById('root')
);
```

##### 使用组件形式传参

```tsx
import React from 'react';
import ReactDOM from 'react-dom';
const App =(prop: any) => <div>my name is {prop.name}</div>
ReactDOM.render(
  <App name="reverside joy"/>, // 使用对象传参
  document.getElementById('root')
);
```

#### 类组件传参

> 类组件中，**`必须要有render方法`**，同时又是一个生命周期钩子函数

```tsx
import React from 'react';
import ReactDOM from 'react-dom';
// 2.使用interface完全声明定义属性类型
interface MyProps {
	name:string; // 必要属性
	age ?: string; //可选属性
	readonly id ?: string; // 只读属性
}
class App extends React.Component<MyProps> {
  render() {
    return (<div>my name is {this.props.name} </div>)
  }
}
ReactDOM.render(
  <App name="test"/>, // 使用对象传参
  document.getElementById('root')
);
```

:::tip

函数组件取值，通过prop.属性名    的方式

类组件取值，通过this.props.属性名    的方式取值

:::

### 组件分文件

#### 类组件形式

1. 组件写法

   1. 先引入react
   2. 然后类组件的通用写法
   3. `最后要使用export default暴露出去`

   ```tsx
   import React from "react";
   class App extends React.Component {
     render() {
       return(<div>这是组件</div>)
     }
   }
   export default App
   ```

2. 入口文件写法

   ```tsx
   // index.tsx
   import ReactDOM from 'react-dom';
   import App from './01-get-start/component'; // 引入组件
   ReactDOM.render(
     <App />, // 使用对象传参
     document.getElementById('root')
   );
   ```

#### 函数组件形式

此处将两个组件写在一起了，分别是Header组件和App组件

App组件又作为入口文件index.tsx的组件

```tsx
import React from "react";
const Header = () => {
    return(<header>是头部</header>)
}
class App extends React.Component {
  render() {
    return(
      <Header/ >
    )
  }
}
export default App
```



#### 组件嵌套

1. 最里面的组件

   ```tsx
   import React, {Component} from "react";
   class Header extends Component{
     render() {
       return(<header>头部</header>)
     }
   }
   export default Header
   ```

2. 倒数第二层组件

   ```tsx
   import React from "react";
   import Header from './header'
   class App extends React.Component {
     render() {
       return(<Header />)
     }
   }
   export default App
   ```

3. 最外层index写法

   ```tsx
   import React from 'react';
   import ReactDOM from 'react-dom';
   import App from './01-get-start/component';
   ReactDOM.render(
     <App />, // 使用对象传参
     document.getElementById('root')
   );
   ```

### return函数中包含多个dom

:::warning

组件根元素只允许有一个，如果需要使用多个，可以在外层包裹<></>，或者使用<Fragment></Fragmen>

Fragment标签需要从react中解构出来

:::

1. 使用Fragment标签

   > Tips: Fragment标签，要从react中解构出来

   ```tsx
   import React, {Component, Fragment} from "react";
   class App extends React.Component {
     render() {
       return(
         <Fragment>
           <Header/ >
           <Main />
         </Fragment>
       )
     }
   }
   ```

2. 使用空标签

   ```tsx
   class App extends React.Component {
     render() {
       return(
         <>
           <Header/ >
           <Main />
         </>
       )
     }
   }
   ```

## Dom的样式

> 如果使用typescript项目，引入css文件，可能出现找不到css文件的情况
>
> 解决方案：
>
> 1. 创建 `globals.d.ts `
>
>    ```ts
>    declare module '*.css'
>    ```
>
> 2. 打开tsconfig.json
>
>    ```json
>    "include": ["./**/*.ts"],
>    "exclude":["node_modules/**/*"]
>    ```
>
>    
>
>    

> 总结：
>
> 1. 行内样式，使用双大括号
> 2. className关键子，使用css定义的字符串类名
> 3. cssnames包，使用单大括号 + 包和样式绑定的实体名称

### 行内样式

1. 行内样式要求CSS必须是一个对象
2. react对于js的识别是使用大括号
3. 对于多单词的CSS属性，要使用小驼峰的写法，如fontSize

所以最外层大括号是react对js的识别，里层的大括号是react要求的对象

```tsx
const App = () => {
  return (
    <div style={{color: 'red', fontSize: '50px'}}>测试页面</div>
  )
}
export default App
```

```tsx
const styleObj = {
    fontSize: '16px'
}
const redObj = {
    color: 'red'
}
const App = () => {
  return (
    <div style={1 > 2 ? styleObj : redObj}>测试页面</div>
  )
}
export default App
```

### 使用className关键字

1. step1: 定义css样式

   ```css
   .fontStyle {
     color: green;
     font-size: 16px;
   }
   ```

2. step2: 引入css文件并`使用className关键字`

   ```tsx
   import './02-test.css'
   const App = () => {
     return (
       <div className="fontStyle">测试页面</div>
     )
   }
   export default App
   ```

### 不同条件显示不同样式：classnames包

有时候需要根据不同的条件添加不同的样式，比如：完成状态，完成是绿色，未完成是红色。那么这种情况下，我们推荐使用[classnames](<https://www.npmjs.com/package/classnames>)这个包

1. 安装

   ```sh
   cnpm install -D classnames
   ```

2. 使用

   1. 定义css文件

      ```css
      .fontStyle {
        color: red;
        font-size: 16px;
      }
      ```

   2. 引入classNames(用于根据条件显示css样式)和style

   3. 引入定义好的css文件，并设置别名

   4. 3.将css样式进行绑定

   ```tsx
   // 1.引入npm包的固定写法
   import classNames from 'classnames/bind';
   // 2.引入自己定义的css文件
   import styles from './02-test.css';
   const App = () => {
     // 3.将css样式进行绑定
     let className = cx({
       fontStyle: false
     })
     return (
       <div className={className}>测试页面</div>
     )
   }
   export default App
   ```

### css  in js

以组件的方式去写css

styled-component 是针对React写的一套css-in-js框架，简单来讲就是在js中写css。[npm链接](<https://www.npmjs.com/package/styled-components>)









