## async-await的纠偏

### 直观但错误的看法：

```js
async function example() {
    console.log('1');
    const result = await fetchData();  // "等待"这个完成
    console.log('2');  // 要等上面执行完才执行
}
```

### 实际发生的事情

```js
async function example() {
    console.log('1');
    
    // await 的真正作用：
    // 1. 暂停当前async函数的执行
    // 2. 将控制权交还给事件循环
    // 3. 其他同步代码可以继续执行
    const result = await fetchData();
    
    console.log('2');  // 等fetchData完成后，这个函数才会恢复执行
}
```

### 举例说明

```vue
<template>
  <div>测试一些</div>
</template>

<script lang="ts" setup>
import { defineComponent, onMounted, reactive, ref } from 'vue'
onMounted(() => {
  console.log('onMounted start')
  testAsync()
  console.log('onMounted end')
})
const testAsync = async () => {
  console.log('testAsync')
  await new Promise(resolve => setTimeout(() => {
    console.log('testAsync 5s')
    resolve()
  }, 5000))
  console.log('testAsync end')
}
</script>

<style lang="less" scoped></style>
```

输出结果

```bash
onMounted start
testAsync
onMounted end
testAsync 5s
testAsync end
```

### 代码解释

1. 首先触发onmounted函数，打印出`onMounted start`
2. 然后调用testAsync方法，打印出`testAsync`
3. 当testAsync继续运行时，发现了promise异步函数，并且前面有await 关键字。
   **于是Promise继续执行(非阻塞)**，将控制权返回给onMounted，testAsync暂停
4. onMounted函数继续打印`onMounted end`
5. onMounted函数结束
6. 等待5秒后(如果有其他任务，可能时间不止5秒)，Promise函数有了结果，testAsync函数继续执行, 打印`testAsync 5s`
7. 最后打印`testAsync end`









