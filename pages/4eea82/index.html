<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>项目部署上线和性能调优 | 麦仁博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="记录前端知识、读书学习">
    
    <link rel="preload" href="/Myblog/assets/css/0.styles.6ca8d52e.css" as="style"><link rel="preload" href="/Myblog/assets/js/app.edc596b5.js" as="script"><link rel="preload" href="/Myblog/assets/js/2.3c9f4522.js" as="script"><link rel="preload" href="/Myblog/assets/js/15.34bb63aa.js" as="script"><link rel="prefetch" href="/Myblog/assets/js/10.80e8354f.js"><link rel="prefetch" href="/Myblog/assets/js/100.4bae90e1.js"><link rel="prefetch" href="/Myblog/assets/js/101.21659d13.js"><link rel="prefetch" href="/Myblog/assets/js/102.26eb113b.js"><link rel="prefetch" href="/Myblog/assets/js/103.86bf0636.js"><link rel="prefetch" href="/Myblog/assets/js/104.354066e3.js"><link rel="prefetch" href="/Myblog/assets/js/105.9224fe4c.js"><link rel="prefetch" href="/Myblog/assets/js/106.6b75deb5.js"><link rel="prefetch" href="/Myblog/assets/js/107.1e7afb78.js"><link rel="prefetch" href="/Myblog/assets/js/108.9a2a778f.js"><link rel="prefetch" href="/Myblog/assets/js/109.0cd53f19.js"><link rel="prefetch" href="/Myblog/assets/js/11.7ffe55e4.js"><link rel="prefetch" href="/Myblog/assets/js/110.18d3d715.js"><link rel="prefetch" href="/Myblog/assets/js/111.bbf76c0f.js"><link rel="prefetch" href="/Myblog/assets/js/112.dbf2c634.js"><link rel="prefetch" href="/Myblog/assets/js/113.235ca818.js"><link rel="prefetch" href="/Myblog/assets/js/114.183cf31c.js"><link rel="prefetch" href="/Myblog/assets/js/115.02769464.js"><link rel="prefetch" href="/Myblog/assets/js/116.116c0282.js"><link rel="prefetch" href="/Myblog/assets/js/117.f85ada18.js"><link rel="prefetch" href="/Myblog/assets/js/118.33f5f444.js"><link rel="prefetch" href="/Myblog/assets/js/119.08db0868.js"><link rel="prefetch" href="/Myblog/assets/js/12.b6507f0c.js"><link rel="prefetch" href="/Myblog/assets/js/120.7220d711.js"><link rel="prefetch" href="/Myblog/assets/js/121.7287ccf2.js"><link rel="prefetch" href="/Myblog/assets/js/122.db0c14d9.js"><link rel="prefetch" href="/Myblog/assets/js/123.d024d0a9.js"><link rel="prefetch" href="/Myblog/assets/js/124.0e7a70b9.js"><link rel="prefetch" href="/Myblog/assets/js/125.e772b632.js"><link rel="prefetch" href="/Myblog/assets/js/126.42a70fdf.js"><link rel="prefetch" href="/Myblog/assets/js/127.ae7ba3a5.js"><link rel="prefetch" href="/Myblog/assets/js/128.f4fc3c51.js"><link rel="prefetch" href="/Myblog/assets/js/129.87883624.js"><link rel="prefetch" href="/Myblog/assets/js/13.27c5af68.js"><link rel="prefetch" href="/Myblog/assets/js/130.dba27d29.js"><link rel="prefetch" href="/Myblog/assets/js/131.a10a3312.js"><link rel="prefetch" href="/Myblog/assets/js/132.3335ce19.js"><link rel="prefetch" href="/Myblog/assets/js/133.b9af9557.js"><link rel="prefetch" href="/Myblog/assets/js/134.e37be1ea.js"><link rel="prefetch" href="/Myblog/assets/js/135.27aa1583.js"><link rel="prefetch" href="/Myblog/assets/js/136.c1185264.js"><link rel="prefetch" href="/Myblog/assets/js/137.1c753e26.js"><link rel="prefetch" href="/Myblog/assets/js/138.1bf89f28.js"><link rel="prefetch" href="/Myblog/assets/js/139.4e027dde.js"><link rel="prefetch" href="/Myblog/assets/js/14.55e28ef4.js"><link rel="prefetch" href="/Myblog/assets/js/140.b53b3058.js"><link rel="prefetch" href="/Myblog/assets/js/141.c6403b18.js"><link rel="prefetch" href="/Myblog/assets/js/142.ac4595ce.js"><link rel="prefetch" href="/Myblog/assets/js/143.5df4d483.js"><link rel="prefetch" href="/Myblog/assets/js/144.e559fa91.js"><link rel="prefetch" href="/Myblog/assets/js/145.219881c7.js"><link rel="prefetch" href="/Myblog/assets/js/146.54c648f7.js"><link rel="prefetch" href="/Myblog/assets/js/147.dbc1a28e.js"><link rel="prefetch" href="/Myblog/assets/js/148.dd7111d6.js"><link rel="prefetch" href="/Myblog/assets/js/149.574e9338.js"><link rel="prefetch" href="/Myblog/assets/js/150.e6d4c3fc.js"><link rel="prefetch" href="/Myblog/assets/js/151.c72ec5b2.js"><link rel="prefetch" href="/Myblog/assets/js/152.cc1e5078.js"><link rel="prefetch" href="/Myblog/assets/js/153.69f3f017.js"><link rel="prefetch" href="/Myblog/assets/js/154.afdd09bb.js"><link rel="prefetch" href="/Myblog/assets/js/155.125b3d74.js"><link rel="prefetch" href="/Myblog/assets/js/156.9f6f8658.js"><link rel="prefetch" href="/Myblog/assets/js/157.109be7d8.js"><link rel="prefetch" href="/Myblog/assets/js/158.7dd2bdc6.js"><link rel="prefetch" href="/Myblog/assets/js/159.e239f69b.js"><link rel="prefetch" href="/Myblog/assets/js/16.06dd1ed4.js"><link rel="prefetch" href="/Myblog/assets/js/160.8cce01bb.js"><link rel="prefetch" href="/Myblog/assets/js/161.f7681be3.js"><link rel="prefetch" href="/Myblog/assets/js/162.da211cc1.js"><link rel="prefetch" href="/Myblog/assets/js/163.872e8836.js"><link rel="prefetch" href="/Myblog/assets/js/164.78402d5b.js"><link rel="prefetch" href="/Myblog/assets/js/165.722e488d.js"><link rel="prefetch" href="/Myblog/assets/js/166.769035be.js"><link rel="prefetch" href="/Myblog/assets/js/167.4f0a9c71.js"><link rel="prefetch" href="/Myblog/assets/js/168.5fb0dc73.js"><link rel="prefetch" href="/Myblog/assets/js/169.b2859331.js"><link rel="prefetch" href="/Myblog/assets/js/17.06c69981.js"><link rel="prefetch" href="/Myblog/assets/js/170.9d5e44eb.js"><link rel="prefetch" href="/Myblog/assets/js/171.ccc67190.js"><link rel="prefetch" href="/Myblog/assets/js/172.c0980ec0.js"><link rel="prefetch" href="/Myblog/assets/js/173.0c30b7ca.js"><link rel="prefetch" href="/Myblog/assets/js/174.06a42d24.js"><link rel="prefetch" href="/Myblog/assets/js/175.2bac98f6.js"><link rel="prefetch" href="/Myblog/assets/js/176.8fe266f1.js"><link rel="prefetch" href="/Myblog/assets/js/177.d6f3d5ff.js"><link rel="prefetch" href="/Myblog/assets/js/178.9761382c.js"><link rel="prefetch" href="/Myblog/assets/js/179.61b20d73.js"><link rel="prefetch" href="/Myblog/assets/js/18.91c8344f.js"><link rel="prefetch" href="/Myblog/assets/js/180.8ef14ae3.js"><link rel="prefetch" href="/Myblog/assets/js/181.90818fc0.js"><link rel="prefetch" href="/Myblog/assets/js/182.f8377ec3.js"><link rel="prefetch" href="/Myblog/assets/js/183.8a076fe9.js"><link rel="prefetch" href="/Myblog/assets/js/184.3f10e065.js"><link rel="prefetch" href="/Myblog/assets/js/185.cd6699c8.js"><link rel="prefetch" href="/Myblog/assets/js/186.7b619454.js"><link rel="prefetch" href="/Myblog/assets/js/187.159874a1.js"><link rel="prefetch" href="/Myblog/assets/js/188.b8363235.js"><link rel="prefetch" href="/Myblog/assets/js/189.c602d398.js"><link rel="prefetch" href="/Myblog/assets/js/19.9948a0d1.js"><link rel="prefetch" href="/Myblog/assets/js/190.6aa05b54.js"><link rel="prefetch" href="/Myblog/assets/js/191.ce1f040c.js"><link rel="prefetch" href="/Myblog/assets/js/192.c90da8f5.js"><link rel="prefetch" href="/Myblog/assets/js/193.df06989f.js"><link rel="prefetch" href="/Myblog/assets/js/194.97f62c14.js"><link rel="prefetch" href="/Myblog/assets/js/195.b2b52ae3.js"><link rel="prefetch" href="/Myblog/assets/js/196.01a7c717.js"><link rel="prefetch" href="/Myblog/assets/js/197.4d2e39e3.js"><link rel="prefetch" href="/Myblog/assets/js/198.3af6f58e.js"><link rel="prefetch" href="/Myblog/assets/js/199.8da7c927.js"><link rel="prefetch" href="/Myblog/assets/js/20.19f0840a.js"><link rel="prefetch" href="/Myblog/assets/js/200.550de219.js"><link rel="prefetch" href="/Myblog/assets/js/201.64b91a27.js"><link rel="prefetch" href="/Myblog/assets/js/202.e7ae6b76.js"><link rel="prefetch" href="/Myblog/assets/js/203.9eb2efe4.js"><link rel="prefetch" href="/Myblog/assets/js/204.6f2201f6.js"><link rel="prefetch" href="/Myblog/assets/js/205.0e8ef3be.js"><link rel="prefetch" href="/Myblog/assets/js/206.3bee54fb.js"><link rel="prefetch" href="/Myblog/assets/js/207.2d356a6d.js"><link rel="prefetch" href="/Myblog/assets/js/208.950fbd8d.js"><link rel="prefetch" href="/Myblog/assets/js/209.c1589e69.js"><link rel="prefetch" href="/Myblog/assets/js/21.99b744ba.js"><link rel="prefetch" href="/Myblog/assets/js/210.7ead7f67.js"><link rel="prefetch" href="/Myblog/assets/js/211.16d385b6.js"><link rel="prefetch" href="/Myblog/assets/js/212.41295fb4.js"><link rel="prefetch" href="/Myblog/assets/js/213.470f8c7a.js"><link rel="prefetch" href="/Myblog/assets/js/214.e0de8283.js"><link rel="prefetch" href="/Myblog/assets/js/215.973c8223.js"><link rel="prefetch" href="/Myblog/assets/js/216.e2d951c3.js"><link rel="prefetch" href="/Myblog/assets/js/217.f39dec0b.js"><link rel="prefetch" href="/Myblog/assets/js/218.aeb611eb.js"><link rel="prefetch" href="/Myblog/assets/js/219.163133e7.js"><link rel="prefetch" href="/Myblog/assets/js/22.d2313add.js"><link rel="prefetch" href="/Myblog/assets/js/220.0c810810.js"><link rel="prefetch" href="/Myblog/assets/js/221.dc6903d4.js"><link rel="prefetch" href="/Myblog/assets/js/222.d3ea26df.js"><link rel="prefetch" href="/Myblog/assets/js/223.96eefbc3.js"><link rel="prefetch" href="/Myblog/assets/js/224.6bbaf86e.js"><link rel="prefetch" href="/Myblog/assets/js/225.2093d769.js"><link rel="prefetch" href="/Myblog/assets/js/226.0f4c3055.js"><link rel="prefetch" href="/Myblog/assets/js/227.72373b5b.js"><link rel="prefetch" href="/Myblog/assets/js/228.0594da7f.js"><link rel="prefetch" href="/Myblog/assets/js/229.3aa983a6.js"><link rel="prefetch" href="/Myblog/assets/js/23.ecae7b6e.js"><link rel="prefetch" href="/Myblog/assets/js/230.233fe1e8.js"><link rel="prefetch" href="/Myblog/assets/js/231.8d51c184.js"><link rel="prefetch" href="/Myblog/assets/js/232.e5e8e55b.js"><link rel="prefetch" href="/Myblog/assets/js/233.a1652a8e.js"><link rel="prefetch" href="/Myblog/assets/js/234.3bce07f2.js"><link rel="prefetch" href="/Myblog/assets/js/235.16b5fe2c.js"><link rel="prefetch" href="/Myblog/assets/js/236.e7f9f942.js"><link rel="prefetch" href="/Myblog/assets/js/237.96e4d6b9.js"><link rel="prefetch" href="/Myblog/assets/js/238.3871ee52.js"><link rel="prefetch" href="/Myblog/assets/js/239.ec0cbc8c.js"><link rel="prefetch" href="/Myblog/assets/js/24.2e293c25.js"><link rel="prefetch" href="/Myblog/assets/js/240.848f927b.js"><link rel="prefetch" href="/Myblog/assets/js/241.b09ed2ed.js"><link rel="prefetch" href="/Myblog/assets/js/242.3b75ca9a.js"><link rel="prefetch" href="/Myblog/assets/js/243.69698265.js"><link rel="prefetch" href="/Myblog/assets/js/244.7599b863.js"><link rel="prefetch" href="/Myblog/assets/js/245.e64767df.js"><link rel="prefetch" href="/Myblog/assets/js/246.f73f38ed.js"><link rel="prefetch" href="/Myblog/assets/js/247.02163d6a.js"><link rel="prefetch" href="/Myblog/assets/js/248.ac914b14.js"><link rel="prefetch" href="/Myblog/assets/js/249.866a4fd7.js"><link rel="prefetch" href="/Myblog/assets/js/25.0de6aad2.js"><link rel="prefetch" href="/Myblog/assets/js/250.46fce67b.js"><link rel="prefetch" href="/Myblog/assets/js/251.2aa659cf.js"><link rel="prefetch" href="/Myblog/assets/js/252.7da2330c.js"><link rel="prefetch" href="/Myblog/assets/js/253.a618bcbf.js"><link rel="prefetch" href="/Myblog/assets/js/254.13fbeca1.js"><link rel="prefetch" href="/Myblog/assets/js/255.f08b7883.js"><link rel="prefetch" href="/Myblog/assets/js/256.6aa58660.js"><link rel="prefetch" href="/Myblog/assets/js/257.65745191.js"><link rel="prefetch" href="/Myblog/assets/js/258.b0e689ed.js"><link rel="prefetch" href="/Myblog/assets/js/259.97b7e7af.js"><link rel="prefetch" href="/Myblog/assets/js/26.902a246c.js"><link rel="prefetch" href="/Myblog/assets/js/260.95d01953.js"><link rel="prefetch" href="/Myblog/assets/js/261.2c3e2c2a.js"><link rel="prefetch" href="/Myblog/assets/js/262.f926a744.js"><link rel="prefetch" href="/Myblog/assets/js/263.9fc35aa7.js"><link rel="prefetch" href="/Myblog/assets/js/264.5c491b11.js"><link rel="prefetch" href="/Myblog/assets/js/265.2d508117.js"><link rel="prefetch" href="/Myblog/assets/js/266.f8e3a14b.js"><link rel="prefetch" href="/Myblog/assets/js/267.bd81c657.js"><link rel="prefetch" href="/Myblog/assets/js/268.34f6394c.js"><link rel="prefetch" href="/Myblog/assets/js/269.586ee894.js"><link rel="prefetch" href="/Myblog/assets/js/27.c1f047a1.js"><link rel="prefetch" href="/Myblog/assets/js/270.99d67250.js"><link rel="prefetch" href="/Myblog/assets/js/271.4f630748.js"><link rel="prefetch" href="/Myblog/assets/js/272.c69d0202.js"><link rel="prefetch" href="/Myblog/assets/js/273.107e4e67.js"><link rel="prefetch" href="/Myblog/assets/js/274.928bf593.js"><link rel="prefetch" href="/Myblog/assets/js/275.c9877942.js"><link rel="prefetch" href="/Myblog/assets/js/276.42b6f10e.js"><link rel="prefetch" href="/Myblog/assets/js/277.611599b8.js"><link rel="prefetch" href="/Myblog/assets/js/278.8f2981ed.js"><link rel="prefetch" href="/Myblog/assets/js/279.ae280f71.js"><link rel="prefetch" href="/Myblog/assets/js/28.0144f44c.js"><link rel="prefetch" href="/Myblog/assets/js/280.2681e17d.js"><link rel="prefetch" href="/Myblog/assets/js/281.a5fd4ad8.js"><link rel="prefetch" href="/Myblog/assets/js/282.0eba43b8.js"><link rel="prefetch" href="/Myblog/assets/js/283.e777f989.js"><link rel="prefetch" href="/Myblog/assets/js/284.e1621125.js"><link rel="prefetch" href="/Myblog/assets/js/285.6521b74b.js"><link rel="prefetch" href="/Myblog/assets/js/286.4b3ac25f.js"><link rel="prefetch" href="/Myblog/assets/js/287.47744453.js"><link rel="prefetch" href="/Myblog/assets/js/288.c36c3964.js"><link rel="prefetch" href="/Myblog/assets/js/289.861368fb.js"><link rel="prefetch" href="/Myblog/assets/js/29.21cbac5e.js"><link rel="prefetch" href="/Myblog/assets/js/290.13adb467.js"><link rel="prefetch" href="/Myblog/assets/js/291.aeade34f.js"><link rel="prefetch" href="/Myblog/assets/js/292.bbeb5e77.js"><link rel="prefetch" href="/Myblog/assets/js/293.f236d9e2.js"><link rel="prefetch" href="/Myblog/assets/js/294.e259db39.js"><link rel="prefetch" href="/Myblog/assets/js/295.a0e5f5d1.js"><link rel="prefetch" href="/Myblog/assets/js/296.e4f2bf43.js"><link rel="prefetch" href="/Myblog/assets/js/297.18396630.js"><link rel="prefetch" href="/Myblog/assets/js/298.7611691b.js"><link rel="prefetch" href="/Myblog/assets/js/299.e61e527f.js"><link rel="prefetch" href="/Myblog/assets/js/3.1ac676e2.js"><link rel="prefetch" href="/Myblog/assets/js/30.59a16f35.js"><link rel="prefetch" href="/Myblog/assets/js/300.6b9e1ec3.js"><link rel="prefetch" href="/Myblog/assets/js/301.2e0aa3a3.js"><link rel="prefetch" href="/Myblog/assets/js/302.d6ffa370.js"><link rel="prefetch" href="/Myblog/assets/js/303.f49c339d.js"><link rel="prefetch" href="/Myblog/assets/js/304.6e528dcf.js"><link rel="prefetch" href="/Myblog/assets/js/305.fa9f0921.js"><link rel="prefetch" href="/Myblog/assets/js/306.7b390249.js"><link rel="prefetch" href="/Myblog/assets/js/307.1fe294e9.js"><link rel="prefetch" href="/Myblog/assets/js/308.c2875830.js"><link rel="prefetch" href="/Myblog/assets/js/309.f8ef3ccd.js"><link rel="prefetch" href="/Myblog/assets/js/31.c5573684.js"><link rel="prefetch" href="/Myblog/assets/js/310.9fdabf07.js"><link rel="prefetch" href="/Myblog/assets/js/311.8a6a09c6.js"><link rel="prefetch" href="/Myblog/assets/js/312.739bf7d8.js"><link rel="prefetch" href="/Myblog/assets/js/313.f1cd2cfb.js"><link rel="prefetch" href="/Myblog/assets/js/314.bb0e4431.js"><link rel="prefetch" href="/Myblog/assets/js/315.2a1f9ac1.js"><link rel="prefetch" href="/Myblog/assets/js/316.79b79116.js"><link rel="prefetch" href="/Myblog/assets/js/317.327796ab.js"><link rel="prefetch" href="/Myblog/assets/js/318.6f8fe0c7.js"><link rel="prefetch" href="/Myblog/assets/js/319.6fcc9b88.js"><link rel="prefetch" href="/Myblog/assets/js/32.ef486437.js"><link rel="prefetch" href="/Myblog/assets/js/320.696aa403.js"><link rel="prefetch" href="/Myblog/assets/js/321.f4fda719.js"><link rel="prefetch" href="/Myblog/assets/js/322.c4cf5a04.js"><link rel="prefetch" href="/Myblog/assets/js/323.b7965d2d.js"><link rel="prefetch" href="/Myblog/assets/js/324.1580153d.js"><link rel="prefetch" href="/Myblog/assets/js/325.4415b43d.js"><link rel="prefetch" href="/Myblog/assets/js/326.63a3d642.js"><link rel="prefetch" href="/Myblog/assets/js/327.2042347d.js"><link rel="prefetch" href="/Myblog/assets/js/328.b93264f7.js"><link rel="prefetch" href="/Myblog/assets/js/329.159996d2.js"><link rel="prefetch" href="/Myblog/assets/js/33.407dd33c.js"><link rel="prefetch" href="/Myblog/assets/js/330.ae9ed63a.js"><link rel="prefetch" href="/Myblog/assets/js/331.73a2f827.js"><link rel="prefetch" href="/Myblog/assets/js/332.085966c4.js"><link rel="prefetch" href="/Myblog/assets/js/333.44d01736.js"><link rel="prefetch" href="/Myblog/assets/js/334.0c7eea21.js"><link rel="prefetch" href="/Myblog/assets/js/335.56eafb9c.js"><link rel="prefetch" href="/Myblog/assets/js/336.05e02b3f.js"><link rel="prefetch" href="/Myblog/assets/js/337.78822f4e.js"><link rel="prefetch" href="/Myblog/assets/js/338.c1cc45dc.js"><link rel="prefetch" href="/Myblog/assets/js/339.0589ae3a.js"><link rel="prefetch" href="/Myblog/assets/js/34.8eb29c1a.js"><link rel="prefetch" href="/Myblog/assets/js/340.3cce9266.js"><link rel="prefetch" href="/Myblog/assets/js/341.a1abf00b.js"><link rel="prefetch" href="/Myblog/assets/js/342.975a4d6e.js"><link rel="prefetch" href="/Myblog/assets/js/343.76f3bb0a.js"><link rel="prefetch" href="/Myblog/assets/js/344.7c33f297.js"><link rel="prefetch" href="/Myblog/assets/js/345.cb70ec32.js"><link rel="prefetch" href="/Myblog/assets/js/346.d2bedbc1.js"><link rel="prefetch" href="/Myblog/assets/js/347.336b528b.js"><link rel="prefetch" href="/Myblog/assets/js/348.d3cbb0ac.js"><link rel="prefetch" href="/Myblog/assets/js/349.af78afbc.js"><link rel="prefetch" href="/Myblog/assets/js/35.c734290c.js"><link rel="prefetch" href="/Myblog/assets/js/350.35a37826.js"><link rel="prefetch" href="/Myblog/assets/js/351.83db975d.js"><link rel="prefetch" href="/Myblog/assets/js/352.8d13e702.js"><link rel="prefetch" href="/Myblog/assets/js/353.085aa68a.js"><link rel="prefetch" href="/Myblog/assets/js/354.0ba4292a.js"><link rel="prefetch" href="/Myblog/assets/js/355.469094b9.js"><link rel="prefetch" href="/Myblog/assets/js/356.e4804c26.js"><link rel="prefetch" href="/Myblog/assets/js/357.7d4367b1.js"><link rel="prefetch" href="/Myblog/assets/js/358.573094f5.js"><link rel="prefetch" href="/Myblog/assets/js/359.247a1ea3.js"><link rel="prefetch" href="/Myblog/assets/js/36.9eb538e0.js"><link rel="prefetch" href="/Myblog/assets/js/360.001e3eb5.js"><link rel="prefetch" href="/Myblog/assets/js/361.5f31ffe3.js"><link rel="prefetch" href="/Myblog/assets/js/362.9abe867a.js"><link rel="prefetch" href="/Myblog/assets/js/363.2fa432c2.js"><link rel="prefetch" href="/Myblog/assets/js/364.d2dfe2fa.js"><link rel="prefetch" href="/Myblog/assets/js/365.a785564d.js"><link rel="prefetch" href="/Myblog/assets/js/366.e2bdbfaa.js"><link rel="prefetch" href="/Myblog/assets/js/367.6a8c3bab.js"><link rel="prefetch" href="/Myblog/assets/js/368.5fd56959.js"><link rel="prefetch" href="/Myblog/assets/js/369.093cf805.js"><link rel="prefetch" href="/Myblog/assets/js/37.7d81d729.js"><link rel="prefetch" href="/Myblog/assets/js/370.501d53ac.js"><link rel="prefetch" href="/Myblog/assets/js/371.d98ab6e4.js"><link rel="prefetch" href="/Myblog/assets/js/372.d235cc25.js"><link rel="prefetch" href="/Myblog/assets/js/373.3d54a3da.js"><link rel="prefetch" href="/Myblog/assets/js/374.fed68d3e.js"><link rel="prefetch" href="/Myblog/assets/js/375.29e3aa7d.js"><link rel="prefetch" href="/Myblog/assets/js/376.5d55aeaa.js"><link rel="prefetch" href="/Myblog/assets/js/377.62a3ea19.js"><link rel="prefetch" href="/Myblog/assets/js/378.4d306310.js"><link rel="prefetch" href="/Myblog/assets/js/379.7ab3089f.js"><link rel="prefetch" href="/Myblog/assets/js/38.8b5fff16.js"><link rel="prefetch" href="/Myblog/assets/js/380.a2482be1.js"><link rel="prefetch" href="/Myblog/assets/js/381.d1237bc2.js"><link rel="prefetch" href="/Myblog/assets/js/382.e5c8f3e3.js"><link rel="prefetch" href="/Myblog/assets/js/383.08201222.js"><link rel="prefetch" href="/Myblog/assets/js/384.44f9282c.js"><link rel="prefetch" href="/Myblog/assets/js/385.0622b8e5.js"><link rel="prefetch" href="/Myblog/assets/js/386.6dde856f.js"><link rel="prefetch" href="/Myblog/assets/js/387.100c3a94.js"><link rel="prefetch" href="/Myblog/assets/js/388.9e17d68a.js"><link rel="prefetch" href="/Myblog/assets/js/389.e7832b1b.js"><link rel="prefetch" href="/Myblog/assets/js/39.0b1bffc7.js"><link rel="prefetch" href="/Myblog/assets/js/390.99c83c32.js"><link rel="prefetch" href="/Myblog/assets/js/391.ded94f85.js"><link rel="prefetch" href="/Myblog/assets/js/392.c9dbea2c.js"><link rel="prefetch" href="/Myblog/assets/js/393.249416b2.js"><link rel="prefetch" href="/Myblog/assets/js/394.23d23c2a.js"><link rel="prefetch" href="/Myblog/assets/js/4.82179151.js"><link rel="prefetch" href="/Myblog/assets/js/40.2e47827f.js"><link rel="prefetch" href="/Myblog/assets/js/41.80c44d66.js"><link rel="prefetch" href="/Myblog/assets/js/42.60bc0849.js"><link rel="prefetch" href="/Myblog/assets/js/43.034dc027.js"><link rel="prefetch" href="/Myblog/assets/js/44.c18ddf2f.js"><link rel="prefetch" href="/Myblog/assets/js/45.221b4df9.js"><link rel="prefetch" href="/Myblog/assets/js/46.73a2b96c.js"><link rel="prefetch" href="/Myblog/assets/js/47.f08a6a9d.js"><link rel="prefetch" href="/Myblog/assets/js/48.b17e5eeb.js"><link rel="prefetch" href="/Myblog/assets/js/49.e6beed20.js"><link rel="prefetch" href="/Myblog/assets/js/5.af2ba816.js"><link rel="prefetch" href="/Myblog/assets/js/50.0e22d778.js"><link rel="prefetch" href="/Myblog/assets/js/51.8dbb44f0.js"><link rel="prefetch" href="/Myblog/assets/js/52.9b45ed7d.js"><link rel="prefetch" href="/Myblog/assets/js/53.134048c0.js"><link rel="prefetch" href="/Myblog/assets/js/54.26e8c0a5.js"><link rel="prefetch" href="/Myblog/assets/js/55.9ec46f98.js"><link rel="prefetch" href="/Myblog/assets/js/56.34d8e143.js"><link rel="prefetch" href="/Myblog/assets/js/57.9f77e345.js"><link rel="prefetch" href="/Myblog/assets/js/58.5e5ada55.js"><link rel="prefetch" href="/Myblog/assets/js/59.e226d13f.js"><link rel="prefetch" href="/Myblog/assets/js/6.84355233.js"><link rel="prefetch" href="/Myblog/assets/js/60.b004f29b.js"><link rel="prefetch" href="/Myblog/assets/js/61.bd423261.js"><link rel="prefetch" href="/Myblog/assets/js/62.18b319d3.js"><link rel="prefetch" href="/Myblog/assets/js/63.bf916a5b.js"><link rel="prefetch" href="/Myblog/assets/js/64.1591852e.js"><link rel="prefetch" href="/Myblog/assets/js/65.24f56934.js"><link rel="prefetch" href="/Myblog/assets/js/66.d8627baf.js"><link rel="prefetch" href="/Myblog/assets/js/67.9ebc1e2d.js"><link rel="prefetch" href="/Myblog/assets/js/68.86a527f2.js"><link rel="prefetch" href="/Myblog/assets/js/69.d4d55be6.js"><link rel="prefetch" href="/Myblog/assets/js/7.db10fe37.js"><link rel="prefetch" href="/Myblog/assets/js/70.b6da28c7.js"><link rel="prefetch" href="/Myblog/assets/js/71.a48a397a.js"><link rel="prefetch" href="/Myblog/assets/js/72.0f54541e.js"><link rel="prefetch" href="/Myblog/assets/js/73.78bf9eca.js"><link rel="prefetch" href="/Myblog/assets/js/74.3c4299e2.js"><link rel="prefetch" href="/Myblog/assets/js/75.fafbaeb1.js"><link rel="prefetch" href="/Myblog/assets/js/76.4d33990a.js"><link rel="prefetch" href="/Myblog/assets/js/77.408df0b2.js"><link rel="prefetch" href="/Myblog/assets/js/78.99d75e14.js"><link rel="prefetch" href="/Myblog/assets/js/79.d8847b3f.js"><link rel="prefetch" href="/Myblog/assets/js/8.bccca1af.js"><link rel="prefetch" href="/Myblog/assets/js/80.5f58d28c.js"><link rel="prefetch" href="/Myblog/assets/js/81.946ade20.js"><link rel="prefetch" href="/Myblog/assets/js/82.32330e3d.js"><link rel="prefetch" href="/Myblog/assets/js/83.a8120d57.js"><link rel="prefetch" href="/Myblog/assets/js/84.32f83870.js"><link rel="prefetch" href="/Myblog/assets/js/85.70da821b.js"><link rel="prefetch" href="/Myblog/assets/js/86.b0f49a4f.js"><link rel="prefetch" href="/Myblog/assets/js/87.5ad10b1a.js"><link rel="prefetch" href="/Myblog/assets/js/88.389fbf45.js"><link rel="prefetch" href="/Myblog/assets/js/89.0373ac03.js"><link rel="prefetch" href="/Myblog/assets/js/9.004ebbef.js"><link rel="prefetch" href="/Myblog/assets/js/90.84104574.js"><link rel="prefetch" href="/Myblog/assets/js/91.ab529f87.js"><link rel="prefetch" href="/Myblog/assets/js/92.bd27a95d.js"><link rel="prefetch" href="/Myblog/assets/js/93.d0cb18d1.js"><link rel="prefetch" href="/Myblog/assets/js/94.0242bfb0.js"><link rel="prefetch" href="/Myblog/assets/js/95.8b68eb9f.js"><link rel="prefetch" href="/Myblog/assets/js/96.32bcae7d.js"><link rel="prefetch" href="/Myblog/assets/js/97.7a63b7a4.js"><link rel="prefetch" href="/Myblog/assets/js/98.a831bb83.js"><link rel="prefetch" href="/Myblog/assets/js/99.52f5970b.js">
    <link rel="stylesheet" href="/Myblog/assets/css/0.styles.6ca8d52e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Myblog/" class="home-link router-link-active"><!----> <span class="site-name">麦仁博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/Myblog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>javaScript笔记精选</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Myblog/pages/03dd97/" class="nav-link">JS常用案例</a></li></ul></li><li class="dropdown-item"><h4>vue学习精选</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Myblog/pages/0082e9/" class="nav-link">《vue基本知识点》</a></li><li class="dropdown-subitem"><a href="/Myblog/pages/24e9bb/" class="nav-link">《vue3的使用》</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Myblog/backEnd/" class="nav-link">后端</a></div><div class="nav-item"><a href="/Myblog/englishLife/" class="nav-link">英语</a></div><div class="nav-item"><a href="/Myblog/bookLife/" class="nav-link">读书</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/Myblog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/Myblog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/Myblog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/Myblog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/Myblog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/Myblog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/Myblog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/Myblog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/Myblog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/MaiRen1997/Myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/Myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/Myblog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>javaScript笔记精选</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Myblog/pages/03dd97/" class="nav-link">JS常用案例</a></li></ul></li><li class="dropdown-item"><h4>vue学习精选</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Myblog/pages/0082e9/" class="nav-link">《vue基本知识点》</a></li><li class="dropdown-subitem"><a href="/Myblog/pages/24e9bb/" class="nav-link">《vue3的使用》</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Myblog/backEnd/" class="nav-link">后端</a></div><div class="nav-item"><a href="/Myblog/englishLife/" class="nav-link">英语</a></div><div class="nav-item"><a href="/Myblog/bookLife/" class="nav-link">读书</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/Myblog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/Myblog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/Myblog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/Myblog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/Myblog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/Myblog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/Myblog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/Myblog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Myblog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/Myblog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/Myblog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/MaiRen1997/Myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python大纲</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Python进阶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Myblog/pages/a95e71/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day01-15</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day16-20</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day31-35</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day36-40</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day41-55</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day56-60</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day61-65</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day66-80</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Day81-90</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Day91-100</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Myblog/pages/ea5c4e/" class="sidebar-link">团队项目开发的问题和解决方案</a></li><li><a href="/Myblog/pages/408365/" class="sidebar-link">MySQL性能优化</a></li><li><a href="/Myblog/pages/aebb1f/" class="sidebar-link">网络API接口设计</a></li><li><a href="/Myblog/pages/eff0fc/" class="sidebar-link">使用Django开发商业项目</a></li><li><a href="/Myblog/pages/d15a0a/" class="sidebar-link">软件测试和自动化测试</a></li><li><a href="/Myblog/pages/289806/" class="sidebar-link">电商网站技术要点剖析</a></li><li><a href="/Myblog/pages/4eea82/" aria-current="page" class="active sidebar-link">项目部署上线和性能调优</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/Myblog/pages/4eea82/#项目部署上线指南" class="sidebar-link">项目部署上线指南</a></li></ul></li><li><a href="/Myblog/pages/648505/" class="sidebar-link">面试中的公共问题</a></li><li><a href="/Myblog/pages/01475b/" class="sidebar-link">Python面试题实录</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>番外篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>年薪50W+的Python程序员如何写代码</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mysql</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/Myblog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/Myblog/backEnd/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/Myblog/backEnd/#Python进阶" data-v-06225672>Python进阶</a></li><li data-v-06225672><a href="/Myblog/backEnd/#Day91-100" data-v-06225672>Day91-100</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/MaiRen1997" target="_blank" title="作者" class="beLink" data-v-06225672>Riverside Joy</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-02-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">项目部署上线和性能调优<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="项目部署上线指南"><a href="#项目部署上线指南" class="header-anchor">#</a> 项目部署上线指南</h2> <h3 id="准备上线"><a href="#准备上线" class="header-anchor">#</a> 准备上线</h3> <ol><li><p>上线前的检查工作。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>python manage.py check <span class="token parameter variable">--deploy</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>将DEBUG设置为False并配置ALLOWED_HOSTS。</p> <div class="language-Python line-numbers-mode"><pre class="language-python"><code>DEBUG <span class="token operator">=</span> <span class="token boolean">False</span>
ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>安全相关的配置。</p> <div class="language-Python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 保持HTTPS连接的时间</span>
SECURE_HSTS_SECONDS <span class="token operator">=</span> <span class="token number">3600</span>
SECURE_HSTS_INCLUDE_SUBDOMAINS <span class="token operator">=</span> <span class="token boolean">True</span>
SECURE_HSTS_PRELOAD <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 自动重定向到安全连接</span>
SECURE_SSL_REDIRECT <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 避免浏览器自作聪明推断内容类型</span>
SECURE_CONTENT_TYPE_NOSNIFF <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 避免跨站脚本攻击</span>
SECURE_BROWSER_XSS_FILTER <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># COOKIE只能通过HTTPS进行传输</span>
SESSION_COOKIE_SECURE <span class="token operator">=</span> <span class="token boolean">True</span>
CSRF_COOKIE_SECURE <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 防止点击劫持攻击手段 - 修改HTTP协议响应头</span>
<span class="token comment"># 当前网站是不允许使用&lt;iframe&gt;标签进行加载的</span>
X_FRAME_OPTIONS <span class="token operator">=</span> <span class="token string">'DENY'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li> <li><p>敏感信息放到环境变量或文件中。</p> <div class="language-Python line-numbers-mode"><pre class="language-python"><code>SECRET_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span>

DB_USER <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'DB_USER'</span><span class="token punctuation">]</span>
DB_PASS <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'DB_PASS'</span><span class="token punctuation">]</span>

REDIS_AUTH <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'REDIS_AUTH'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ol> <h3 id="更新服务器python环境到3-x"><a href="#更新服务器python环境到3-x" class="header-anchor">#</a> 更新服务器Python环境到3.x</h3> <blockquote><p>说明：如果需要清除之前的安装，就删除对应的文件和文件夹即可</p></blockquote> <ol><li><p>安装底层依赖库。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel libdb4-devel libpcap-devel xz-devel libffi-devel libxml2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>下载Python源代码。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">wget</span> https://www.python.org/ftp/python/3.7.6/Python-3.7.6.tar.xz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>验证下载文件。</p> <div class="language-Bash line-numbers-mode"><pre class="language-bash"><code>md5sum Python-3.7.6.tar.xz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>解压缩和解归档。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>xz <span class="token parameter variable">-d</span> Python-3.7.6.tar.xz
<span class="token function">tar</span> <span class="token parameter variable">-xvf</span> Python-3.7.6.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>执行安装前的配置（生成Makefile文件）。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> Python-3.7.6
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/python37 --enable-optimizations
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>构建和安装。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>配置PATH环境变量（用户或系统环境变量）并激活。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> ~/.bash_profile
<span class="token function">vim</span> /etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-INI line-numbers-mode"><pre class="language-ini"><code>... 此处省略上面的代码...

<span class="token key attr-name">export PATH</span><span class="token punctuation">=</span><span class="token value attr-value">$PATH:/usr/local/python37/bin</span>

... 此处省略下面的代码...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">source</span> ~/.bash_profile
<span class="token builtin class-name">source</span> /etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>注册软链接（符号链接）- 这一步不是必须的，但通常会比较有用。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/local/python37/bin/python3 /usr/bin/python3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>测试Python环境是否更新成功（安装Python 3一定不能破坏原来的Python 2）。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>python3 <span class="token parameter variable">--version</span>
python <span class="token parameter variable">--version</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h3 id="项目目录结构"><a href="#项目目录结构" class="header-anchor">#</a> 项目目录结构</h3> <p>假设项目文件夹为<code>project</code>，下面的五个子目录分别是：<code>code</code>、<code>conf</code>、<code>logs</code>、<code>stat</code>和<code>venv</code>分别用来保存项目的代码、配置文件、日志文件、静态资源和虚拟环境。其中，<code>conf</code>目录下的子目录<code>cert</code>中保存了配置HTTPS需要使用的证书和密钥；<code>code</code>目录下的项目代码可以通过版本控制工具从代码仓库中检出；虚拟环境可以通过工具（如：venv、virtualenv、pyenv等）进行创建。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>project
├── code
│   └── fangtx
│       ├── api
│       ├── common
│       ├── fangtx
│       ├── forum
│       ├── rent
│       ├── user
│       ├── manage.py
│       ├── README.md
│       ├── static
│       └── templates
├── conf
│   ├── cert
│   │   ├── 214915882850706.key
│   │   └── 214915882850706.pem
│   ├── nginx.conf
│   └── uwsgi.ini
├── logs
│   ├── access.log
│   ├── error.log
│   └── uwsgi.log
├── stat
│   └── css
│   └── images
│   └── js
└── venv
    ├── bin
    │   ├── activate
    │   ├── activate.csh
    │   ├── activate.fish
    │   ├── celery
    │   ├── celerybeat
    │   ├── celeryd
    │   ├── celeryd-multi
    │   ├── coverage
    │   ├── coverage3
    │   ├── coverage-3.7
    │   ├── django-admin
    │   ├── django-admin.py
    │   ├── easy_install
    │   ├── easy_install-3.7
    │   ├── pip
    │   ├── pip3
    │   ├── pip3.7
    │   ├── __pycache__
    │   ├── pyrsa-decrypt
    │   ├── pyrsa-decrypt-bigfile
    │   ├── pyrsa-encrypt
    │   ├── pyrsa-encrypt-bigfile
    │   ├── pyrsa-keygen
    │   ├── pyrsa-priv2pub
    │   ├── pyrsa-sign
    │   ├── pyrsa-verify
    │   ├── python -&gt; python3
    │   ├── python3 -&gt; /usr/bin/python3
    │   └── uwsgi
    ├── include
    ├── lib
    │   └── python3.7
    ├── lib64 -&gt; lib
    ├── pip-selfcheck.json
    └── pyvenv.cfg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>下面以阿里云为例，简单说明如何为项目注册域名、解析域名以及购买权威机构颁发的证书。</p> <ol><li><p><a href="https://wanwang.aliyun.com/domain/" target="_blank" rel="noopener noreferrer">注册域名<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/Myblog/assets/img/aliyun-domain.29b37d62.png" alt=""></p></li> <li><p><a href="https://beian.aliyun.com/" target="_blank" rel="noopener noreferrer">域名备案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/Myblog/assets/img/aliyun-keeprecord.49fccb27.png" alt=""></p></li> <li><p><a href="https://dns.console.aliyun.com/#/dns/domainList" target="_blank" rel="noopener noreferrer">域名解析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/Myblog/assets/img/aliyun-dnslist.1ce0f399.png" alt=""></p> <p><img src="/Myblog/assets/img/aliyun-resolve-settings.20111c05.png" alt=""></p></li> <li><p><a href="https://www.aliyun.com/product/cas" target="_blank" rel="noopener noreferrer">购买证书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><img src="/Myblog/assets/img/aliyun-certificate.e8f309f1.png" alt=""></p></li></ol> <p>可以使用类似于sftp的工具将证书上传到<code>conf/cert</code>目录，然后使用git克隆项目代码到<code>code</code>目录。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> code
<span class="token function">git</span> clone <span class="token operator">&lt;</span>url<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>回到项目目录，创建并激活虚拟环境。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>python3 <span class="token parameter variable">-m</span> venv venv
<span class="token builtin class-name">source</span> venv/bin/activate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>重建项目依赖项。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>pip <span class="token function">install</span> <span class="token parameter variable">-r</span> code/teamproject/requirements.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="uwsgi的配置"><a href="#uwsgi的配置" class="header-anchor">#</a> uWSGI的配置</h3> <ol><li><p>安装uWSGI。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>pip <span class="token function">install</span> uwsgi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改uWSGI的配置文件（<code>/root/project/conf/uwsgi.ini</code>）。</p> <div class="language-INI line-numbers-mode"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">uwsgi</span><span class="token punctuation">]</span></span>
<span class="token comment"># 配置前导路径</span>
<span class="token key attr-name">base</span><span class="token punctuation">=</span><span class="token value attr-value">/root/project</span>
<span class="token comment"># 配置项目名称</span>
<span class="token key attr-name">name</span><span class="token punctuation">=</span><span class="token value attr-value">teamproject</span>
<span class="token comment"># 守护进程</span>
<span class="token key attr-name">master</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># 进程个数</span>
<span class="token key attr-name">processes</span><span class="token punctuation">=</span><span class="token value attr-value">4</span>
<span class="token comment"># 虚拟环境</span>
<span class="token key attr-name">pythonhome</span><span class="token punctuation">=</span><span class="token value attr-value">%(base)/venv</span>
<span class="token comment"># 项目地址</span>
<span class="token key attr-name">chdir</span><span class="token punctuation">=</span><span class="token value attr-value">%(base)/code/%(name)</span>
<span class="token comment"># 指定python解释器</span>
<span class="token key attr-name">pythonpath</span><span class="token punctuation">=</span><span class="token value attr-value">%(pythonhome)/bin/python</span>
<span class="token comment"># 指定uwsgi文件</span>
<span class="token key attr-name">module</span><span class="token punctuation">=</span><span class="token value attr-value">%(name).wsgi</span>
<span class="token comment"># 通信的地址和端口(自己服务器的IP地址和端口)</span>
<span class="token key attr-name">socket</span><span class="token punctuation">=</span><span class="token value attr-value">172.18.61.250:8000</span>
<span class="token comment"># 日志文件地址</span>
<span class="token key attr-name">logto</span><span class="token punctuation">=</span><span class="token value attr-value">%(base)/logs/uwsgi.log</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>说明：可以先将“通信的地址和端口”项等号前面改为http来进行测试，如果没有问题再改回    成socket，然后通过Nginx来实现项目的“动静分离”（静态资源交给Nginx处理，动态内容交给    uWSGI处理）。按照下面的方式可以启动uWSGI服务器。</p></blockquote></li> <li><p>启动服务器。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">nohup</span> uwsgi <span class="token parameter variable">--ini</span> conf/uwsgi.ini <span class="token operator">&amp;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <h3 id="nginx的配置"><a href="#nginx的配置" class="header-anchor">#</a> Nginx的配置</h3> <ol><li><p>安装Nginx。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改全局配置文件（<code>/etc/nginx/nginx.conf</code>）。</p> <div class="language-Nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment"># 配置用户</span>
<span class="token directive"><span class="token keyword">user</span> nginx</span><span class="token punctuation">;</span>
<span class="token comment"># 工作进程数(建议跟CPU的核数量一致)</span>
<span class="token directive"><span class="token keyword">worker_processes</span> auto</span><span class="token punctuation">;</span>
<span class="token comment"># 错误日志</span>
<span class="token directive"><span class="token keyword">error_log</span> /var/log/nginx/error.log</span><span class="token punctuation">;</span>
<span class="token comment"># 进程文件</span>
<span class="token directive"><span class="token keyword">pid</span> /run/nginx.pid</span><span class="token punctuation">;</span>
<span class="token comment"># 包含其他的配置</span>
<span class="token directive"><span class="token keyword">include</span> /usr/share/nginx/modules/*.conf</span><span class="token punctuation">;</span>
<span class="token comment"># 工作模式(多路IO复用方式)和连接上限</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">use</span> epoll</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">worker_connections</span> <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment"># HTTP服务器相关配置</span>
<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    <span class="token comment"># 日志格式</span>
    <span class="token directive"><span class="token keyword">log_format</span>  main  <span class="token string">'<span class="token variable">$remote_addr</span> - <span class="token variable">$remote_user</span> [<span class="token variable">$time_local]</span> &quot;<span class="token variable">$request</span>&quot; '</span>
                      <span class="token string">'<span class="token variable">$status</span> <span class="token variable">$body_bytes_sent</span> &quot;<span class="token variable">$http_referer</span>&quot; '</span>
                      <span class="token string">'&quot;<span class="token variable">$http_user_agent</span>&quot; &quot;<span class="token variable">$http_x_forwarded_for</span>&quot;'</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 访问日志</span>
    <span class="token directive"><span class="token keyword">access_log</span>  /var/log/nginx/access.log  main</span><span class="token punctuation">;</span>
    <span class="token comment"># 开启高效文件传输模式</span>
    <span class="token directive"><span class="token keyword">sendfile</span>            <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 用sendfile传输文件时有利于改善性能</span>
    <span class="token directive"><span class="token keyword">tcp_nopush</span>          <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 禁用Nagle来解决交互性问题</span>
    <span class="token directive"><span class="token keyword">tcp_nodelay</span>         <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 客户端保持连接时间</span>
    <span class="token directive"><span class="token keyword">keepalive_timeout</span>   <span class="token number">30</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span></span><span class="token punctuation">;</span>
    <span class="token comment"># 包含MIME类型的配置</span>
    <span class="token directive"><span class="token keyword">include</span>             /etc/nginx/mime.types</span><span class="token punctuation">;</span>
    <span class="token comment"># 默认使用二进制流格式</span>
    <span class="token directive"><span class="token keyword">default_type</span>        application/octet-stream</span><span class="token punctuation">;</span>
    <span class="token comment"># 包含其他配置文件</span>
    <span class="token directive"><span class="token keyword">include</span> /etc/nginx/conf.d/*.conf</span><span class="token punctuation">;</span>
    <span class="token comment"># 包含项目的Nginx配置文件</span>
    <span class="token directive"><span class="token keyword">include</span> /root/project/conf/*.conf</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></li> <li><p>编辑局部配置文件（<code>/root/project/conf/nginx.conf</code>）。</p> <div class="language-Nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>      <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> _</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">access_log</span> /root/project/logs/access.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">error_log</span> /root/project/logs/error.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">include</span> uwsgi_params</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">uwsgi_pass</span> 172.18.61.250:8000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> /static/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">alias</span> /root/project/stat/</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">expires</span> <span class="token number">30d</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>      <span class="token number">443</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> _</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl</span>         <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">access_log</span> /root/project/logs/access.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">error_log</span> /root/project/logs/error.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate</span>     /root/project/conf/cert/214915882850706.pem</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /root/project/conf/cert/214915882850706.key</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_session_timeout</span> <span class="token number">5m</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_protocols</span> TLSv1 TLSv1.1 TLSv1.2</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_prefer_server_ciphers</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">include</span> uwsgi_params</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">uwsgi_pass</span> 172.18.61.250:8000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> /static/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">alias</span> /root/project/static/</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">expires</span> <span class="token number">30d</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>到此为止，我们可以启动Nginx来访问我们的应用程序，HTTP和HTTPS都是没有问题的，如果Nginx已经运行，在修改配置文件后，我们可以用下面的命令重新启动Nginx。</p></li> <li><p>重启Nginx服务器。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>nginx <span class="token parameter variable">-s</span> reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>systemctl restart nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <blockquote><p>说明：可以对Django项目使用<code>python manage.py collectstatic</code>命令将静态资源收集到指定目录下，要做到这点只需要在项目的配置文件<code>settings.py</code>中添加<code>STATIC_ROOT</code>配置即可。</p></blockquote> <h4 id="负载均衡配置"><a href="#负载均衡配置" class="header-anchor">#</a> 负载均衡配置</h4> <p>下面的配置中我们使用Nginx实现负载均衡，为另外的三个Nginx服务器（通过Docker创建）提供反向代理服务。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">801</span>:80 <span class="token parameter variable">--name</span> nginx1 nginx:latest
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">802</span>:80 <span class="token parameter variable">--name</span> nginx2 nginx:latest
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">803</span>:80 <span class="token parameter variable">--name</span> nginx3 nginx:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-Nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">user</span> root</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">worker_processes</span> auto</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">error_log</span> /var/log/nginx/error.log</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">pid</span> /run/nginx.pid</span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">include</span> /usr/share/nginx/modules/*.conf</span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span> <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># 为HTTP服务配置负载均衡</span>
<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
	<span class="token directive"><span class="token keyword">upstream</span> xx</span> <span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.1.100 weight=2</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.1.101 weight=1</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.1.102 weight=1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span> default_server</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">listen</span>       [::]:80 default_server</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">listen</span>       <span class="token number">443</span> ssl</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">listen</span>       [::]:443 ssl</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">ssl</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">access_log</span> /root/project/logs/access.log</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">error_log</span> /root/project/logs/error.log</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_certificate</span> /root/project/conf/cert/214915882850706.pem</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_certificate_key</span> /root/project/conf/cert/214915882850706.key</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_session_timeout</span> <span class="token number">5m</span></span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_protocols</span> TLSv1 TLSv1.1 TLSv1.2</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">ssl_prefer_server_ciphers</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>

		<span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
			<span class="token comment"># proxy_set_header X-Real-IP $remote_addr;</span>
			<span class="token comment"># proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
			<span class="token directive"><span class="token keyword">proxy_buffering</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
			<span class="token directive"><span class="token keyword">proxy_pass</span> http://fangtx</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><blockquote><p>说明：Nginx在配置负载均衡时，默认使用WRR（加权轮询算法），除此之外还支持ip_hash、fair（需要安装upstream_fair模块）和url_hash算法。此外，在配置upstream模块时可以指定服务器的状态值，包括：backup（备份机器，其他服务器不可用时才将请求分配到该机器）、down、fail_timeout（请求失败达到max_fails后的暂停服务时间）、max_fails（允许请求失败的次数）和weight（轮询的权重）。</p></blockquote> <h3 id="keepalived"><a href="#keepalived" class="header-anchor">#</a> Keepalived</h3> <p>当使用Nginx进行负载均衡配置时，要考虑负载均衡服务器宕机的情况。为此可以使用Keepalived来实现负载均衡主机和备机的热切换，从而保证系统的高可用性。Keepalived的配置还是比较复杂，通常由专门做运维的人进行配置，一个基本的配置可以参照<a href="https://www.jianshu.com/p/dd93bc6d45f5" target="_blank" rel="noopener noreferrer">《Keepalived的配置和使用》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="mysql主从复制"><a href="#mysql主从复制" class="header-anchor">#</a> MySQL主从复制</h3> <p>下面还是基于Docker来演示如何配置MySQL主从复制。我们事先准备好MySQL的配置文件以及保存MySQL数据和运行日志的目录，然后通过Docker的数据卷映射来指定容器的配置、数据和日志文件的位置。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>root
└── mysql
    ├── master
    │   ├── conf
    <span class="token operator">|</span>	└── data
    └── slave-1
    <span class="token operator">|</span>	├── conf
    <span class="token operator">|</span>	└── data
    └── slave-2
    <span class="token operator">|</span>	├── conf
    <span class="token operator">|</span>	└── data
    └── slave-3
    	├── conf
    	└── data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol><li><p>MySQL的配置文件（master和slave的配置文件需要不同的server-id）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[mysqld]
pid-file=/var/run/mysqld/mysqld.pid
socket=/var/run/mysqld/mysqld.sock
datadir=/var/lib/mysql
log-error=/var/log/mysql/error.log
server-id=1
log-bin=/var/log/mysql/mysql-bin.log
expire_logs_days=30
max_binlog_size=256M
symbolic-links=0
# slow_query_log=ON
# slow_query_log_file=/var/log/mysql/slow.log
# long_query_time=1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>创建和配置master。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">--name</span> mysql-master <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/master/conf:/etc/mysql/mysql.conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/master/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> mysql:5.7

<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql-master /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">1</span>
Server version: <span class="token number">5.7</span>.23-log MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2018</span>, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">&gt;</span> grant replication slave on *.* to <span class="token string">'slave'</span>@<span class="token string">'%'</span> identified by <span class="token string">'iamslave'</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected, <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> flush privileges<span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> show master status<span class="token punctuation">;</span>
+------------------+----------+--------------+------------------+-------------------+
<span class="token operator">|</span> File             <span class="token operator">|</span> Position <span class="token operator">|</span> Binlog_Do_DB <span class="token operator">|</span> Binlog_Ignore_DB <span class="token operator">|</span> Executed_Gtid_Set <span class="token operator">|</span>
+------------------+----------+--------------+------------------+-------------------+
<span class="token operator">|</span> mysql-bin.000003 <span class="token operator">|</span>      <span class="token number">590</span> <span class="token operator">|</span>              <span class="token operator">|</span>                  <span class="token operator">|</span>                   <span class="token operator">|</span>
+------------------+----------+--------------+------------------+-------------------+
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> quit
Bye
<span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>上面创建Docker容器时使用的<code>-v</code>参数（<code>--volume</code>）表示映射数据卷，冒号前是宿主机的目录，冒号后是容器中的目录，这样相当于将宿主机中的目录挂载到了容器中。</p></li> <li><p>备份主表中的数据（如果需要的话）。</p> <div class="language-SQL line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> flush <span class="token keyword">table</span> <span class="token keyword">with</span> <span class="token keyword">read</span> <span class="token keyword">lock</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-Bash line-numbers-mode"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span> <span class="token number">123456</span> <span class="token parameter variable">-A</span> <span class="token parameter variable">-B</span> <span class="token operator">&gt;</span> /root/backup/mysql/mybak<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&quot;%Y%m%d%H%M%S&quot;</span><span class="token variable">)</span></span>.sql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-SQL line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">unlock</span> <span class="token keyword">table</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>创建和配置slave。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3308</span>:3306 <span class="token parameter variable">--name</span> mysql-slave-1 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-1/conf:/etc/mysql/mysql.conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-1/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--link</span> mysql-master:mysql-master mysql:5.7

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3309</span>:3306 <span class="token parameter variable">--name</span> mysql-slave-2 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-2/conf:/etc/mysql/mysql.conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-2/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--link</span> mysql-master:mysql-master mysql:5.7

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3310</span>:3306 <span class="token parameter variable">--name</span> mysql-slave-3 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-3/conf:/etc/mysql/mysql.conf.d <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/slave-3/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--link</span> mysql-master:mysql-master mysql:5.7

<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> mysql-slave-1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or <span class="token punctuation">\</span>g.
Your MySQL connection <span class="token function">id</span> is <span class="token number">2</span>
Server version: <span class="token number">5.7</span>.23-log MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2018</span>, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">&gt;</span> reset slave<span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> change master to <span class="token assign-left variable">master_host</span><span class="token operator">=</span><span class="token string">'mysql-master'</span>, <span class="token assign-left variable">master_user</span><span class="token operator">=</span><span class="token string">'slave'</span>, <span class="token assign-left variable">master_password</span><span class="token operator">=</span><span class="token string">'iamslave'</span>, <span class="token assign-left variable">master_log_file</span><span class="token operator">=</span><span class="token string">'mysql-bin.000003'</span>, <span class="token assign-left variable">master_log_pos</span><span class="token operator">=</span><span class="token number">590</span><span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected, <span class="token number">2</span> warnings <span class="token punctuation">(</span><span class="token number">0.03</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> start slave<span class="token punctuation">;</span>
Query OK, <span class="token number">0</span> rows affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> show slave status<span class="token punctuation">\</span>G
*************************** <span class="token number">1</span>. row ***************************
               Slave_IO_State: Waiting <span class="token keyword">for</span> master to send event
                  Master_Host: mysql57
                  Master_User: slave
                  Master_Port: <span class="token number">3306</span>
                Connect_Retry: <span class="token number">60</span>
              Master_Log_File: mysql-bin.000001
          Read_Master_Log_Pos: <span class="token number">590</span>
               Relay_Log_File: f352f05eb9d0-relay-bin.000002
                Relay_Log_Pos: <span class="token number">320</span>
        Relay_Master_Log_File: mysql-bin.000001
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
             Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: <span class="token number">0</span>
                   Last_Error:
                 Skip_Counter: <span class="token number">0</span>
          Exec_Master_Log_Pos: <span class="token number">590</span>
              Relay_Log_Space: <span class="token number">534</span>
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: <span class="token number">0</span>
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: <span class="token number">0</span>
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: <span class="token number">0</span>
                Last_IO_Error:
               Last_SQL_Errno: <span class="token number">0</span>
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: <span class="token number">1</span>
                  Master_UUID: 30c38043-ada1-11e8-8fa1-0242ac110002
             Master_Info_File: /var/lib/mysql/master.info
                    SQL_Delay: <span class="token number">0</span>
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has <span class="token builtin class-name">read</span> all relay log<span class="token punctuation">;</span> waiting <span class="token keyword">for</span> <span class="token function">more</span> updates
           Master_Retry_Count: <span class="token number">86400</span>
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set:
            Executed_Gtid_Set:
                Auto_Position: <span class="token number">0</span>
         Replicate_Rewrite_DB:
                 Channel_Name:
           Master_TLS_Version:
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> quit
Bye
<span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><p>接下来可以如法炮制配置出slave2和slave3，这样就可以搭建起一个“一主带三从”的主从复制环境。上面创建创建容器时使用的<code>--link</code>参数用来配置容器在网络上的主机名（网络地址别名）。</p></li></ol> <p>配置好主从复制后，写数据的操作应该master上执行，而读数据的操作应该在slave上完成。为此，在Django项目中需要配置DATABASE_ROUTERS并通过自定义的主从复制路由类来实现读写分离操作，如下所示：</p> <div class="language-Python line-numbers-mode"><pre class="language-python"><code>DATABASE_ROUTERS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 此处省略其他配置</span>
    <span class="token string">'common.routers.MasterSlaveRouter'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-Python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MasterSlaveRouter</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;主从复制路由&quot;&quot;&quot;</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">db_for_read</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token operator">**</span>hints<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Attempts to read auth models go to auth_db.
        &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'slave1'</span><span class="token punctuation">,</span> <span class="token string">'slave2'</span><span class="token punctuation">,</span> <span class="token string">'slave3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">db_for_write</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token operator">**</span>hints<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Attempts to write auth models go to auth_db.
        &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token string">'default'</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">allow_relation</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">,</span> <span class="token operator">**</span>hints<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Allow relations if a model in the auth app is involved.
        &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">allow_migrate</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> app_label<span class="token punctuation">,</span> model_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>hints<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Make sure the auth app only appears in the 'auth_db'
        database.
        &quot;&quot;&quot;</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>上面的内容参考了Django官方文档的<a href="https://docs.djangoproject.com/en/2.1/topics/db/multi-db/#topics-db-multi-db-routing" target="_blank" rel="noopener noreferrer">DATABASE_ROUTERS配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，对代码进行了适当的调整。</p> <h3 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h3> <p>事实上，项目上线中最为麻烦的事情就是配置软件运行环境，环境的差异会给软件的安装和部署带来诸多的麻烦，而Docker正好可以解决这个问题。关于Docker在之前的文档中我们已经介绍过了，接下来我们对Docker的知识做一些必要的补充。</p> <ol><li><p>创建镜像文件。</p> <p>将容器保存成镜像：</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;...&quot;</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;jackfrued&quot;</span> <span class="token operator">&lt;</span>container-name<span class="token operator">&gt;</span> jackfrued/<span class="token operator">&lt;</span>image-name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用Dockerfile构建镜像：</p> <div class="language-Dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token comment"># 指定基础镜像文件</span>
<span class="token instruction"><span class="token keyword">FROM</span> centos:latest</span>

<span class="token comment"># 指定维护者信息</span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span> jackfrued</span>

<span class="token comment"># 执行命令</span>
<span class="token instruction"><span class="token keyword">RUN</span> yum -y install gcc</span>
<span class="token instruction"><span class="token keyword">RUN</span> cd ~</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p project/code</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p project/logs</span>

<span class="token comment"># 拷贝文件</span>
<span class="token instruction"><span class="token keyword">COPY</span> ...</span>

<span class="token comment"># 暴露端口</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> ...</span>

<span class="token comment"># 在容器启动时执行命令</span>
<span class="token instruction"><span class="token keyword">CMD</span> ~/init.sh</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> jackfrued/<span class="token operator">&lt;</span>image-name<span class="token operator">&gt;</span> <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>镜像的导入和导出。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> save <span class="token parameter variable">-o</span> <span class="token operator">&lt;</span>file-name<span class="token operator">&gt;</span>.tar <span class="token operator">&lt;</span>image-name<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span>
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>file-name<span class="token operator">&gt;</span>.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>推送到DockerHub服务器。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> tag <span class="token operator">&lt;</span>image-name<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span> jackfrued/<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>
<span class="token function">docker</span> login
<span class="token function">docker</span> push jackfrued/<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>容器之间的通信。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">--link</span> <span class="token operator">&lt;</span>container-name<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>alias-name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <p>如果我们能够在Docker中完成项目的部署，并且将整个部署好的容器打包成镜像文件进行分发和安装，这样就可以解决项目在多个节点上进行部署时可能遇到的麻烦，而且整个部署可以在很短的时间内完成。</p> <h3 id="supervisor"><a href="#supervisor" class="header-anchor">#</a> Supervisor</h3> <p><a href="https://github.com/Supervisor/supervisor" target="_blank" rel="noopener noreferrer">Supervisor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个用Python写的进程管理工具，可以很方便的用来在类Unix系统下启动、重启（自动重启程序）和关闭进程，目前Supervisor暂时还没有提供对Python 3的支持，可以通过Python 2来安装和运行Supervisor，再通过Supervisor来管理Python 3的程序。</p> <blockquote><p><strong>提示</strong>：还有一个和Supervisor功能类似的工具名为Circus，支持Python 3。</p></blockquote> <ol><li><p>安装Supervisor。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>virtualenv <span class="token parameter variable">-p</span> /usr/bin/python venv
<span class="token builtin class-name">source</span> venv/bin/activate
pip <span class="token function">install</span> supervisor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>查看Supervisor的配置文件。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /etc/supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-INI line-numbers-mode"><pre class="language-ini"><code><span class="token comment">; 此处省略上面的代码</span>
<span class="token comment">; The [include] section can just contain the &quot;files&quot; setting.  This</span>
<span class="token comment">; setting can list multiple files (separated by whitespace or</span>
<span class="token comment">; newlines).  It can also contain wildcards.  The filenames are</span>
<span class="token comment">; interpreted as relative to this file.  Included files *cannot*</span>
<span class="token comment">; include files themselves.</span>
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">include</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">files</span> <span class="token punctuation">=</span> <span class="token value attr-value">supervisord.d/*.ini</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>可以看出自定义的管理配置代码可以放在<code>/etc/supervisord.d</code>目录中，并且文件名以<code>ini</code>作为后缀即可。</p></li> <li><p>编写自己的配置文件<code>fangtx.ini</code>并放在<code>/etc/supervisord.d</code>目录中。</p> <div class="language-INI line-numbers-mode"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">program:project</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">command</span><span class="token punctuation">=</span><span class="token value attr-value">uwsgi --ini /root/project/conf/uwsgi.ini</span>
<span class="token key attr-name">stopsignal</span><span class="token punctuation">=</span><span class="token value attr-value">QUIT</span>
<span class="token key attr-name">autostart</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">autorestart</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">redirect_stderr</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">program:celery</span><span class="token punctuation">]</span></span>
<span class="token comment">; Set full path to celery program if using virtualenv</span>
<span class="token key attr-name">command</span><span class="token punctuation">=</span><span class="token value attr-value">/root/project/venv/bin/celery -A fangtx worker</span>
<span class="token key attr-name">user</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">numprocs</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token key attr-name">stdout_logfile</span><span class="token punctuation">=</span><span class="token value attr-value">/var/log/supervisor/celery.log</span>
<span class="token key attr-name">stderr_logfile</span><span class="token punctuation">=</span><span class="token value attr-value">/var/log/supervisor/celery_error.log</span>
<span class="token key attr-name">autostart</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">autorestart</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">startsecs</span><span class="token punctuation">=</span><span class="token value attr-value">10</span>

<span class="token comment">; Need to wait for currently executing tasks to finish at shutdown.</span>
<span class="token comment">; Increase this if you have very long running tasks.</span>
<span class="token comment">;stopwaitsecs = 600</span>

<span class="token comment">; When resorting to send SIGKILL to the program to terminate it</span>
<span class="token comment">; send SIGKILL to its whole process group instead,</span>
<span class="token comment">; taking care of its children as well.</span>
<span class="token key attr-name">killasgroup</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment">; Set Celery priority higher than default (999)</span>
<span class="token comment">; so, if rabbitmq is supervised, it will start first.</span>
<span class="token key attr-name">priority</span><span class="token punctuation">=</span><span class="token value attr-value">1000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li> <li><p>启动Supervisor。</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code>supervisorctl <span class="token parameter variable">-c</span> /etc/supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <h3 id="其他服务"><a href="#其他服务" class="header-anchor">#</a> 其他服务</h3> <ol><li><p>常用开源软件。</p> <table><thead><tr><th>功能</th> <th>开源方案</th></tr></thead> <tbody><tr><td>版本控制工具</td> <td>Git、Mercurial、SVN</td></tr> <tr><td>缺陷管理</td> <td>Redmine、Mantis</td></tr> <tr><td>负载均衡</td> <td>Nginx、LVS、HAProxy</td></tr> <tr><td>邮件服务</td> <td>Postfix、Sendmail</td></tr> <tr><td>HTTP服务</td> <td>Nginx、Apache</td></tr> <tr><td>消息队列</td> <td>RabbitMQ、ZeroMQ、Redis、Kafka</td></tr> <tr><td>文件系统</td> <td>FastDFS</td></tr> <tr><td>基于位置服务（LBS）</td> <td>MongoDB、Redis</td></tr> <tr><td>监控服务</td> <td>Nagios、Zabbix</td></tr> <tr><td>关系型数据库</td> <td>MySQL、PostgreSQL</td></tr> <tr><td>非关系型数据库</td> <td>MongoDB、Redis、Cassandra、TiDB</td></tr> <tr><td>搜索引擎</td> <td>ElasticSearch、Solr</td></tr> <tr><td>缓存服务</td> <td>Mamcached、Redis</td></tr></tbody></table></li> <li><p>常用云服务。</p> <table><thead><tr><th>功能</th> <th>可用的云服务</th></tr></thead> <tbody><tr><td>团队协作工具</td> <td>Teambition、钉钉</td></tr> <tr><td>代码托管平台</td> <td>Github、Gitee、CODING</td></tr> <tr><td>邮件服务</td> <td>SendCloud</td></tr> <tr><td>云存储（CDN）</td> <td>七牛、OSS、LeanCloud、Bmob、又拍云、S3</td></tr> <tr><td>移动端推送</td> <td>极光、友盟、百度</td></tr> <tr><td>即时通信</td> <td>环信、融云</td></tr> <tr><td>短信服务</td> <td>云片、极光、Luosimao、又拍云</td></tr> <tr><td>第三方登录</td> <td>友盟、ShareSDK</td></tr> <tr><td>网站监控和统计</td> <td>阿里云监控、监控宝、百度云观测、小鸟云</td></tr></tbody></table></li></ol></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/MaiRen1997/Myblog/edit/master/docs/02.后端/15.Python进阶/11.Day91-100/98.项目部署上线和性能调优.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2/26/2025, 2:58:15 AM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/Myblog/pages/289806/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">电商网站技术要点剖析</div></a> <a href="/Myblog/pages/648505/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">面试中的公共问题</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Myblog/pages/289806/" class="prev">电商网站技术要点剖析</a></span> <span class="next"><a href="/Myblog/pages/648505/">面试中的公共问题</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/Myblog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/Myblog/pages/91aff2/"><div>
            20250215
            <!----></div></a> <span class="date">02-18</span></dt></dl><dl><dd>02</dd> <dt><a href="/Myblog/pages/475e19/"><div>
            读音与音标
            <!----></div></a> <span class="date">02-12</span></dt></dl><dl><dd>03</dd> <dt><a href="/Myblog/pages/8f1623/"><div>
            20250208
            <!----></div></a> <span class="date">02-10</span></dt></dl> <dl><dd></dd> <dt><a href="/Myblog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/Myblog/assets/js/app.edc596b5.js" defer></script><script src="/Myblog/assets/js/2.3c9f4522.js" defer></script><script src="/Myblog/assets/js/15.34bb63aa.js" defer></script>
  </body>
</html>
