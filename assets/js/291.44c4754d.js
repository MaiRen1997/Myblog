(window.webpackJsonp=window.webpackJsonp||[]).push([[291],{881:function(e,a,s){"use strict";s.r(a);var n=s(7),t=Object(n.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("PDF是Portable Document Format的缩写，这类文件通常使用"),a("code",[e._v(".pdf")]),e._v("作为其扩展名。在日常开发工作中，最容易遇到的就是从PDF中读取文本内容以及用已有的内容生成PDF文档这两个任务。")]),e._v(" "),a("h2",{attrs:{id:"从pdf中提取文本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从pdf中提取文本"}},[e._v("#")]),e._v(" 从PDF中提取文本")]),e._v(" "),a("p",[e._v("在Python中，可以使用名为"),a("code",[e._v("PyPDF2")]),e._v("的三方库来读取PDF文件，可以使用下面的命令来安装它。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("pip install PyPDF2\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[a("code",[e._v("PyPDF2")]),e._v("没有办法从PDF文档中提取图像、图表或其他媒体，但它可以提取文本，并将其返回为Python字符串。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("import PyPDF2\n\nreader = PyPDF2.PdfReader('test.pdf')\nfor page in reader.pages:\n    print(page.extract_text())\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("blockquote",[a("p",[a("strong",[e._v("提示")]),e._v("：上面代码中使用的PDF文件“test.pdf”以及下面的代码中需要用到的PDF文件，也可以通过下面的百度云盘地址进行获取。链接:https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g 提取码:e7b4。")])]),e._v(" "),a("p",[e._v("当然，"),a("code",[e._v("PyPDF2")]),e._v("并不是什么样的PDF文档都能提取出文字来，这个问题就我所知并没有什么特别好的解决方法，尤其是在提取中文的时候。网上也有很多讲解从PDF中提取文字的文章，推荐大家自行阅读"),a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1395339",target:"_blank",rel:"noopener noreferrer"}},[e._v("《三大神器助力Python提取pdf文档信息》"),a("OutboundLink")],1),e._v("一文进行了解。")]),e._v(" "),a("p",[e._v("要从PDF文件中提取文本也可以直接使用三方的命令行工具，具体的做法如下所示。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("pip install pdfminer.six\npdf2text.py test.pdf\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"旋转和叠加页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#旋转和叠加页面"}},[e._v("#")]),e._v(" 旋转和叠加页面")]),e._v(" "),a("p",[e._v("上面的代码中通过创建"),a("code",[e._v("PdfFileReader")]),e._v("对象的方式来读取PDF文档，该对象的"),a("code",[e._v("getPage")]),e._v("方法可以获得PDF文档的指定页并得到一个"),a("code",[e._v("PageObject")]),e._v("对象，通过"),a("code",[e._v("PageObject")]),e._v("对象的"),a("code",[e._v("rotateClockwise")]),e._v("和"),a("code",[e._v("rotateCounterClockwise")]),e._v("方法可以实现页面的顺时针和逆时针方向旋转，通过"),a("code",[e._v("PageObject")]),e._v("对象的"),a("code",[e._v("addBlankPage")]),e._v("方法可以添加一个新的空白页，代码如下所示。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("reader = PyPDF2.PdfReader('XGBoost.pdf')\nwriter = PyPDF2.PdfWriter()\n\nfor no, page in enumerate(reader.pages):\n    if no % 2 == 0:\n        new_page = page.rotate(-90)\n    else:\n        new_page = page.rotate(90)\n    writer.add_page(new_page)\n\nwith open('temp.pdf', 'wb') as file_obj:\n    writer.write(file_obj)\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("h2",{attrs:{id:"加密pdf文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加密pdf文件"}},[e._v("#")]),e._v(" 加密PDF文件")]),e._v(" "),a("p",[e._v("使用"),a("code",[e._v("PyPDF2")]),e._v("中的"),a("code",[e._v("PdfFileWrite")]),e._v("对象可以为PDF文档加密，如果需要给一系列的PDF文档设置统一的访问口令，使用Python程序来处理就会非常的方便。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("import PyPDF2\n\nreader = PyPDF2.PdfReader('XGBoost.pdf')\nwriter = PyPDF2.PdfWriter()\n\nfor page in reader.pages:\n    writer.add_page(page)\n    \nwriter.encrypt('foobared')\n\nwith open('temp.pdf', 'wb') as file_obj:\n    writer.write(file_obj)\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br")])]),a("h2",{attrs:{id:"批量添加水印"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量添加水印"}},[e._v("#")]),e._v(" 批量添加水印")]),e._v(" "),a("p",[e._v("上面提到的"),a("code",[e._v("PageObject")]),e._v("对象还有一个名为"),a("code",[e._v("mergePage")]),e._v("的方法，可以两个PDF页面进行叠加，通过这个操作，我们很容易实现给PDF文件添加水印的功能。例如要给上面的“XGBoost.pdf”文件添加一个水印，我们可以先准备好一个提供水印页面的PDF文件，然后将包含水印的"),a("code",[e._v("PageObject")]),e._v("读取出来，然后再循环遍历“XGBoost.pdf”文件的每个页，获取到"),a("code",[e._v("PageObject")]),e._v("对象，然后通过"),a("code",[e._v("mergePage")]),e._v("方法实现水印页和原始页的合并，代码如下所示。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("reader1 = PyPDF2.PdfReader('XGBoost.pdf')\nreader2 = PyPDF2.PdfReader('watermark.pdf')\nwriter = PyPDF2.PdfWriter()\nwatermark_page = reader2.pages[0]\n\nfor page in reader1.pages:\n    page.merge_page(watermark_page)\n    writer.add_page(page)\n\nwith open('temp.pdf', 'wb') as file_obj:\n    writer.write(file_obj)\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br")])]),a("p",[e._v("如果愿意，还可以让奇数页和偶数页使用不同的水印，大家可以自己思考下应该怎么做。")]),e._v(" "),a("h2",{attrs:{id:"创建pdf文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建pdf文件"}},[e._v("#")]),e._v(" 创建PDF文件")]),e._v(" "),a("p",[e._v("创建PDF文档需要三方库"),a("code",[e._v("reportlab")]),e._v("的支持，安装的方法如下所示。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("pip install reportlab\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("下面通过一个例子为大家展示"),a("code",[e._v("reportlab")]),e._v("的用法。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("from reportlab.lib.pagesizes import A4\nfrom reportlab.pdfbase import pdfmetrics\nfrom reportlab.pdfbase.ttfonts import TTFont\nfrom reportlab.pdfgen import canvas\n\npdf_canvas = canvas.Canvas('resources/demo.pdf', pagesize=A4)\nwidth, height = A4\n\n# 绘图\nimage = canvas.ImageReader('resources/guido.jpg')\npdf_canvas.drawImage(image, 20, height - 395, 250, 375)\n\n# 显示当前页\npdf_canvas.showPage()\n\n# 注册字体文件\npdfmetrics.registerFont(TTFont('Font1', 'resources/fonts/Vera.ttf'))\npdfmetrics.registerFont(TTFont('Font2', 'resources/fonts/青呱石头体.ttf'))\n\n# 写字\npdf_canvas.setFont('Font2', 40)\npdf_canvas.setFillColorRGB(0.9, 0.5, 0.3, 1)\npdf_canvas.drawString(width // 2 - 120, height // 2, '你好，世界！')\npdf_canvas.setFont('Font1', 40)\npdf_canvas.setFillColorRGB(0, 1, 0, 0.5)\npdf_canvas.rotate(18)\npdf_canvas.drawString(250, 250, 'hello, world!')\n\n# 保存\npdf_canvas.save()\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br"),a("span",{staticClass:"line-number"},[e._v("24")]),a("br"),a("span",{staticClass:"line-number"},[e._v("25")]),a("br"),a("span",{staticClass:"line-number"},[e._v("26")]),a("br"),a("span",{staticClass:"line-number"},[e._v("27")]),a("br"),a("span",{staticClass:"line-number"},[e._v("28")]),a("br"),a("span",{staticClass:"line-number"},[e._v("29")]),a("br"),a("span",{staticClass:"line-number"},[e._v("30")]),a("br")])]),a("p",[e._v("上面的代码如果不太理解也没有关系，等真正需要用Python创建PDF文档的时候，再好好研读一下"),a("code",[e._v("reportlab")]),e._v("的"),a("a",{attrs:{href:"https://www.reportlab.com/docs/reportlab-userguide.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),a("OutboundLink")],1),e._v("就可以了。")]),e._v(" "),a("blockquote",[a("p",[a("strong",[e._v("提示")]),e._v("：上面代码中用到的图片和字体，也可以通过下面的百度云盘链接获取。链接:https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g 提取码:e7b4。")])])])}),[],!1,null,null,null);a.default=t.exports}}]);