(window.webpackJsonp=window.webpackJsonp||[]).push([[251],{824:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"新建nginx配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建nginx配置文件"}},[s._v("#")]),s._v(" 新建nginx配置文件")]),s._v(" "),a("p",[s._v("在nginx文件夹中的conf.d文件夹中，新建一个文件，文件名称命名为"),a("code",[s._v("文件名称.conf")]),s._v(",代码如下")]),s._v(" "),a("h2",{attrs:{id:"nginx配置代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置代码"}},[s._v("#")]),s._v(" nginx配置代码")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name  localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#access_log  /var/log/nginx/host.access.log  main;")]),s._v("\n\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root   /home/www/wbjFront"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$uri")]),s._v(" /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#让所有未匹配的请求都返回 index.html，由 Vue Router 处理路由")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#error_page  404              /404.html;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redirect server error pages to the static page /50x.html")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    error_page   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /50x.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /50x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root   /usr/share/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("如果前端配置proxy，那么nginx,也要拦截接口上的特定字符，用来转发")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("location /api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass   http://127.0.0.1:8000/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#此处的地址为服务器的地址，以及部署后端代码的端口号")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"重启nginx配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启nginx配置"}},[s._v("#")]),s._v(" 重启nginx配置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"什么是端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是端口"}},[s._v("#")]),s._v(" 什么是端口")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("定义：")]),s._v(" 端口是一个数字，用于标识计算机上运行的应用程序或服务。")]),s._v(" "),a("li",[a("strong",[s._v("作用：")]),s._v(" 计算机上的不同应用程序需要进行通信，端口就是用来区分这些不同应用程序的。每个端口都有一个唯一的数字，通常范围是 0 到 65535。")]),s._v(" "),a("li",[a("strong",[s._v("分类：")]),s._v(" "),a("ul",[a("li",[s._v("系统端口（Well-known Ports）： 范围是 0 到 1023，用于一些知名的服务，例如 HTTP 使用的端口 80，HTTPS 使用的端口 443。")]),s._v(" "),a("li",[s._v("注册端口（Registered Ports）： 范围是 1024 到 49151，用于用户注册的应用程序。")]),s._v(" "),a("li",[s._v("动态或私有端口（Dynamic or Private Ports）： 范围是 49152 到 65535，用于动态分配或私有协议。")])])])]),s._v(" "),a("h2",{attrs:{id:"查找nginx占用端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查找nginx占用端口"}},[s._v("#")]),s._v(" 查找nginx占用端口")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("ps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用 ps -ef|grep nginx 这个命令来查找当前服务器下，正在运行的nginx进程，一个服务器下可以部署多个nginx来为web项目服务")]),s._v(" "),a("p",[s._v("从上图我查找的nignx进程来看，我服务部署了两个nginx，并且可以看到，每个nginx都有一个master process 和worker process ，在这里表示主进程和工作进程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/MaiRen1997/mdPic/vueImg/202401231529443.webp",alt:"image.png"}})]),s._v(" "),a("p",[a("code",[s._v("主进程只有一个，但是工作进程可以有多个")]),s._v("。")]),s._v(" "),a("p",[s._v("主进程（Master Process）主要负责管理工作进程，处理配置文件的重新加载等任务。")]),s._v(" "),a("p",[s._v("工作进程（Worker Process）主要用于实际处理客户端请求")]),s._v(" "),a("h2",{attrs:{id:"什么是进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是进程"}},[s._v("#")]),s._v(" 什么是进程")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("定义：")]),s._v(" 进程是计算机中正在运行的程序的实例。一个程序可以同时运行多个进程，每个进程都有自己的内存空间和系统资源。")]),s._v(" "),a("li",[a("strong",[s._v("作用：")]),s._v(" 进程是计算机执行任务和管理资源的基本单位。每个进程都有自己的代码、数据、内存空间，以及与其他进程隔离的执行环境。")]),s._v(" "),a("li",[a("strong",[s._v("特点：")]),s._v(" "),a("ul",[a("li",[s._v("独立性：进程之间是相互独立的，一个进程的错误不会影响其他进程。")]),s._v(" "),a("li",[s._v("并发执行： 计算机可以同时运行多个进程，提高系统的效率和资源利用率。")]),s._v(" "),a("li",[s._v("通信： 进程之间可以通过进程间通信（IPC）进行数据交换和协作。")])])])]),s._v(" "),a("h2",{attrs:{id:"清除进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清除进程"}},[s._v("#")]),s._v(" 清除进程")]),s._v(" "),a("p",[s._v("由于进程的独立性，每个进程都会拥有自己的端口，昨天在部署前端环境的时候，起了8088的nginx配置， 会出现以下的情况 "),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/MaiRen1997/mdPic/vueImg/202401231554587.webp",alt:"image.png"}})]),s._v(" "),a("p",[s._v("会显示nginx想要在8088端口上面启动，但是发现该端口已经被占用了， Address already in use，地址已经被使用了，当前的nginx想要再次在这个端口启动服务是不行的。")]),s._v(" "),a("p",[s._v("因为在计算机上的应用程序需要和网络进行通信时，它会使用端口来标识自己，而网络上的其他计算机可以通过指定端口来连接到该应用程序，所以每个端口也可以说是地址都应该是唯一的")]),s._v(" "),a("p",[s._v("当遇到这个情况可以找到已经使用的端口来进行清除，前提你知道这个端口用的服务是不重要的，可以直接kill的")]),s._v(" "),a("h2",{attrs:{id:"查看应用占用的端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看应用占用的端口"}},[s._v("#")]),s._v(" 查看应用占用的端口")]),s._v(" "),a("p",[s._v("使用 sudo netstat -tulpn | grep :8088 来查找某个端口使用的进程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/MaiRen1997/mdPic/vueImg/202401231554583.webp",alt:"image.png"}})]),s._v(" "),a("p",[s._v("可以看到是某个以321结尾的进程号的进程占用了8088的端口，我们直接清除即可")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/MaiRen1997/mdPic/vueImg/202401231529415.webp",alt:"image.png"}})]),s._v(" "),a("p",[s._v("清除完成之后即可重新启动nginx在8088端口上")]),s._v(" "),a("h2",{attrs:{id:"配置负载均衡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置负载均衡"}},[s._v("#")]),s._v(" 配置负载均衡")]),s._v(" "),a("h3",{attrs:{id:"轮询-默认方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#轮询-默认方式"}},[s._v("#")]),s._v(" 轮询（默认方式）")]),s._v(" "),a("p",[s._v("Nginx 默认采用 "),a("strong",[s._v("轮询（Round Robin）")]),s._v(" 方式，将请求依次分配给后端服务器。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            proxy_pass http://backend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"加权轮询-weighted-round-robin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加权轮询-weighted-round-robin"}},[s._v("#")]),s._v(" 加权轮询（Weighted Round Robin）")]),s._v(" "),a("p",[s._v("如果后端服务器的性能不同，可以使用 "),a("strong",[s._v("权重（weight）")]),s._v(" 来调整请求分配比例。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 权重高，接收更多请求")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"ip-哈希-ip-hash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ip-哈希-ip-hash"}},[s._v("#")]),s._v(" IP 哈希（IP Hash）")]),s._v(" "),a("p",[a("strong",[s._v("IP 哈希（ip_hash）")]),s._v(" 方式保证相同客户端 IP 的请求总是被分配到同一台后端服务器，适用于会话保持的场景")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ip_hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"最少连接-least-connections"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最少连接-least-connections"}},[s._v("#")]),s._v(" 最少连接（Least Connections）")]),s._v(" "),a("p",[a("strong",[s._v("least_conn")]),s._v(" 方式将请求分配给当前连接数最少的服务器，适用于长连接的业务")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    least_conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"健康检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#健康检查"}},[s._v("#")]),s._v(" 健康检查")]),s._v(" "),a("p",[s._v("可以使用 "),a("code",[s._v("max_fails")]),s._v(" 和 "),a("code",[s._v("fail_timeout")]),s._v(" 配置健康检查，防止请求分配到不可用的服务器。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_fails")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("fail_timeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"动态负载均衡-结合-keepalived"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态负载均衡-结合-keepalived"}},[s._v("#")]),s._v(" 动态负载均衡（结合 Keepalived）")]),s._v(" "),a("p",[s._v("如果需要主从切换，可以结合 "),a("strong",[s._v("Keepalived")]),s._v(" 实现 "),a("strong",[s._v("高可用性（HA）")]),s._v("。(下面有详细讲述)")]),s._v(" "),a("h3",{attrs:{id:"结合-nginx-stream-实现-tcp-负载均衡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结合-nginx-stream-实现-tcp-负载均衡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("结合 Nginx Stream 实现 TCP 负载均衡")])]),s._v(" "),a("p",[s._v("如果需要负载均衡 TCP 流量（如数据库、MQ），可以使用 "),a("code",[s._v("stream")]),s._v(" 模块")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("stream "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101:3306"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102:3306"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        proxy_pass backend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"动态负载均衡-结合-keepalived-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态负载均衡-结合-keepalived-2"}},[s._v("#")]),s._v(" 动态负载均衡（结合 Keepalived）")]),s._v(" "),a("p",[s._v("Keepalived 主要用于 "),a("strong",[s._v("Nginx 的高可用（HA，High Availability）")]),s._v("，它通过 "),a("strong",[s._v("VRRP（虚拟路由冗余协议）")]),s._v(" 提供 "),a("strong",[s._v("VIP（虚拟 IP 地址）")]),s._v("，实现主备切换，避免单点故障（Single Point of Failure, SPOF）。")]),s._v(" "),a("p",[s._v("假设有两台 "),a("strong",[s._v("Nginx 负载均衡服务器")]),s._v("：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("主（Master）")]),s._v("："),a("code",[s._v("192.168.1.10")])]),s._v(" "),a("li",[a("strong",[s._v("备（Backup）")]),s._v("："),a("code",[s._v("192.168.1.11")])]),s._v(" "),a("li",[a("strong",[s._v("虚拟 IP（VIP）")]),s._v("："),a("code",[s._v("192.168.1.100")])])]),s._v(" "),a("h3",{attrs:{id:"配置-nginx-负载均衡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-nginx-负载均衡"}},[s._v("#")]),s._v(" 配置 Nginx 负载均衡")]),s._v(" "),a("h4",{attrs:{id:"在-master-和-backup-服务器上安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-master-和-backup-服务器上安装-nginx"}},[s._v("#")]),s._v(" 在 Master 和 Backup 服务器上安装 Nginx")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu/Debian")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"配置-nginx-负载均衡-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-nginx-负载均衡-2"}},[s._v("#")]),s._v(" 配置 Nginx 负载均衡")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/etc/nginx/nginx.conf")]),s._v(" 中添加("),a("strong",[s._v("在 Master 和 Backup 服务器都配置相同的 Nginx 负载均衡规则")]),s._v("。)")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后端服务器1")]),s._v("\n        server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.102"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后端服务器2")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server_name localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            proxy_pass http://backend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"安装-keepalived"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-keepalived"}},[s._v("#")]),s._v(" 安装 Keepalived")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" keepalived "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu/Debian")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" keepalived "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"配置-keepalived"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-keepalived"}},[s._v("#")]),s._v(" 配置 Keepalived")]),s._v(" "),a("h4",{attrs:{id:"在-master-服务器-192-168-1-10-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-master-服务器-192-168-1-10-配置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("在 Master 服务器 ("),a("code",[s._v("192.168.1.10")]),s._v(") 配置")])]),s._v(" "),a("p",[s._v("编辑 "),a("code",[s._v("/etc/keepalived/keepalived.conf")]),s._v("：")]),s._v(" "),a("p",[a("code",[s._v("实际使用过程中，按需求，修改虚拟IP(virtual_ipaddress)")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("vrrp_instance VI_1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    state MASTER            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主服务器")]),s._v("\n    interface eth0          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网卡名称（使用 `ip a` 查看）")]),s._v("\n    virtual_router_id "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# VRRP组ID，主备要一致")]),s._v("\n    priority "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主服务器优先级高于 Backup")]),s._v("\n    advert_int "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 心跳间隔（秒）")]),s._v("\n    \n    authentication "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        auth_type PASS\n        auth_pass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主备服务器的认证密码，要一致")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    virtual_ipaddress "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.100       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# VIP（虚拟 IP）")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    track_process "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h4",{attrs:{id:"在-backup-服务器-192-168-1-11-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-backup-服务器-192-168-1-11-配置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("在 Backup 服务器 ("),a("code",[s._v("192.168.1.11")]),s._v(") 配置")])]),s._v(" "),a("p",[s._v("编辑 "),a("code",[s._v("/etc/keepalived/keepalived.conf")]),s._v("：")]),s._v(" "),a("p",[a("code",[s._v("实际使用过程中，按需求，修改虚拟IP(virtual_ipaddress)")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("vrrp_instance VI_1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    state BACKUP            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备服务器")]),s._v("\n    interface eth0          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网卡名称")]),s._v("\n    virtual_router_id "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# VRRP组ID，与 Master 保持一致")]),s._v("\n    priority "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备服务器优先级低于 Master")]),s._v("\n    advert_int "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 心跳间隔（秒）")]),s._v("\n\n    authentication "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        auth_type PASS\n        auth_pass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 认证密码，要与 Master 一致")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    virtual_ipaddress "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.100       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# VIP（虚拟 IP）")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    track_process "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h4",{attrs:{id:"启动-keepalived-并验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-keepalived-并验证"}},[s._v("#")]),s._v(" 启动 Keepalived 并验证")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart keepalived\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" keepalived\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"检查-vip-是否生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查-vip-是否生效"}},[s._v("#")]),s._v(" 检查 VIP 是否生效")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.100\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("在 "),a("strong",[s._v("Master 服务器")]),s._v(" 上应该能看到 "),a("code",[s._v("192.168.1.100")])]),s._v(" "),a("li",[s._v("停止 "),a("code",[s._v("keepalived")]),s._v(" 进程 ("),a("code",[s._v("sudo systemctl stop keepalived")]),s._v(")，VIP 应该会自动漂移到 "),a("strong",[s._v("Backup 服务器")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);