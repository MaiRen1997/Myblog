(window.webpackJsonp=window.webpackJsonp||[]).push([[464],{968:function(a,s,t){"use strict";t.r(s);var e=t(8),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"go的依赖管理go-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go的依赖管理go-module"}},[a._v("#")]),a._v(" Go的依赖管理Go Module")]),a._v(" "),s("h2",{attrs:{id:"来源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#来源"}},[a._v("#")]),a._v(" 来源")]),a._v(" "),s("p",[a._v("https://www.liwenzhou.com/posts/Go/go_dependency/")]),a._v(" "),s("h2",{attrs:{id:"历史遗留问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#历史遗留问题"}},[a._v("#")]),a._v(" 历史遗留问题")]),a._v(" "),s("p",[a._v("如果是使用Go1.11和Go1.12版本，需要手动开启Go module支持")]),a._v(" "),s("p",[s("img",{attrs:{src:"images/image-20200906202108891.png",alt:"image-20200906202108891"}})]),a._v(" "),s("h2",{attrs:{id:"为什么需要依赖管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要依赖管理"}},[a._v("#")]),a._v(" 为什么需要依赖管理")]),a._v(" "),s("p",[a._v("最早的时候，Go所依赖的所有的第三方库都放在GOPATH这个目录下面。这就导致了同一个库只能保存一个版本的代码。如果不同的项目依赖同一个第三方的库的不同版本，应该怎么解决？")]),a._v(" "),s("h2",{attrs:{id:"godep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#godep"}},[a._v("#")]),a._v(" godep")]),a._v(" "),s("p",[a._v("Go语言从v1.5开始开始引入"),s("code",[a._v("vendor")]),a._v("模式，如果项目目录下有vendor目录，那么go工具链会优先使用"),s("code",[a._v("vendor")]),a._v("内的包进行编译、测试等。")]),a._v(" "),s("p",[s("code",[a._v("godep")]),a._v("是一个通过vender模式实现的Go语言的第三方依赖管理工具，类似的还有由社区维护准官方包管理工具"),s("code",[a._v("dep")]),a._v("。")]),a._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("执行以下命令安装"),s("code",[a._v("godep")]),a._v("工具。")]),a._v(" "),s("div",{staticClass:"language-go line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("go")]),a._v(" get github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("tools"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("godep\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"基本命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[a._v("#")]),a._v(" 基本命令")]),a._v(" "),s("p",[a._v("安装好godep之后，在终端输入"),s("code",[a._v("godep")]),a._v("查看支持的所有命令。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("godep save     将依赖项输出并复制到Godeps.json文件中\ngodep go       使用保存的依赖项运行go工具\ngodep get      下载并安装具有指定依赖项的包\ngodep path     打印依赖的GOPATH路径\ngodep restore  在GOPATH中拉取依赖的版本\ngodep update   更新选定的包或go版本\ngodep "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("diff")]),a._v("     显示当前和以前保存的依赖项集之间的差异\ngodep version  查看版本信息\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("使用"),s("code",[a._v("godep help [command]")]),a._v("可以看看具体命令的帮助信息。")]),a._v(" "),s("h3",{attrs:{id:"使用godep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用godep"}},[a._v("#")]),a._v(" 使用godep")]),a._v(" "),s("p",[a._v("在项目目录下执行"),s("code",[a._v("godep save")]),a._v("命令，会在当前项目中创建"),s("code",[a._v("Godeps")]),a._v("和"),s("code",[a._v("vender")]),a._v("两个文件夹。")]),a._v(" "),s("p",[a._v("其中"),s("code",[a._v("Godeps")]),a._v("文件夹下有一个"),s("code",[a._v("Godeps.json")]),a._v("的文件，里面记录了项目所依赖的包信息。 "),s("code",[a._v("vender")]),a._v("文件夹下是项目依赖的包的源代码文件。")]),a._v(" "),s("h3",{attrs:{id:"vender机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vender机制"}},[a._v("#")]),a._v(" vender机制")]),a._v(" "),s("p",[a._v("Go1.5版本之后开始支持，能够控制Go语言程序编译时依赖包搜索路径的优先级。")]),a._v(" "),s("p",[a._v("例如查找项目的某个依赖包，首先会在项目根目录下的"),s("code",[a._v("vender")]),a._v("文件夹中查找，如果没有找到就会去"),s("code",[a._v("$GOAPTH/src")]),a._v("目录下查找。")]),a._v(" "),s("h3",{attrs:{id:"godep开发流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#godep开发流程"}},[a._v("#")]),a._v(" godep开发流程")]),a._v(" "),s("ol",[s("li",[a._v("保证程序能够正常编译")]),a._v(" "),s("li",[a._v("执行"),s("code",[a._v("godep save")]),a._v("保存当前项目的所有第三方依赖的版本信息和代码")]),a._v(" "),s("li",[a._v("提交Godeps目录和vender目录到代码库。")]),a._v(" "),s("li",[a._v("如果要更新依赖的版本，可以直接修改"),s("code",[a._v("Godeps.json")]),a._v("文件中的对应项")])]),a._v(" "),s("h2",{attrs:{id:"go-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-module"}},[a._v("#")]),a._v(" go module")]),a._v(" "),s("p",[s("code",[a._v("go module")]),a._v("是Go1.11版本之后官方推出的版本管理工具，并且从Go1.13版本开始，"),s("code",[a._v("go module")]),a._v("将是Go语言默认的依赖管理工具。")]),a._v(" "),s("h3",{attrs:{id:"go111module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go111module"}},[a._v("#")]),a._v(" GO111MODULE")]),a._v(" "),s("p",[a._v("要启用"),s("code",[a._v("go module")]),a._v("支持首先要设置环境变量"),s("code",[a._v("GO111MODULE")]),a._v("，通过它可以开启或关闭模块支持，它有三个可选值："),s("code",[a._v("off")]),a._v("、"),s("code",[a._v("on")]),a._v("、"),s("code",[a._v("auto")]),a._v("，默认值是"),s("code",[a._v("auto")]),a._v("。")]),a._v(" "),s("ol",[s("li",[s("code",[a._v("GO111MODULE=off")]),a._v("禁用模块支持，编译时会从"),s("code",[a._v("GOPATH")]),a._v("和"),s("code",[a._v("vendor")]),a._v("文件夹中查找包。")]),a._v(" "),s("li",[s("code",[a._v("GO111MODULE=on")]),a._v("启用模块支持，编译时会忽略"),s("code",[a._v("GOPATH")]),a._v("和"),s("code",[a._v("vendor")]),a._v("文件夹，只根据 "),s("code",[a._v("go.mod")]),a._v("下载依赖。")]),a._v(" "),s("li",[s("code",[a._v("GO111MODULE=auto")]),a._v("，当项目在"),s("code",[a._v("$GOPATH/src")]),a._v("外且项目根目录有"),s("code",[a._v("go.mod")]),a._v("文件时，开启模块支持。")])]),a._v(" "),s("p",[a._v("简单来说，设置"),s("code",[a._v("GO111MODULE=on")]),a._v("之后就可以使用"),s("code",[a._v("go module")]),a._v("了，以后就没有必要在GOPATH中创建项目了，并且还能够很好的管理项目依赖的第三方包信息。")]),a._v(" "),s("p",[a._v("使用 go module 管理依赖后会在项目根目录下生成两个文件"),s("code",[a._v("go.mod")]),a._v("和"),s("code",[a._v("go.sum")]),a._v("。")]),a._v(" "),s("h3",{attrs:{id:"goproxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#goproxy"}},[a._v("#")]),a._v(" GOPROXY")]),a._v(" "),s("p",[a._v("Go1.11之后设置GOPROXY命令为：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOPROXY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("https://goproxy.cn\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("Go1.13之后"),s("code",[a._v("GOPROXY")]),a._v("默认值为"),s("code",[a._v("https://proxy.golang.org")]),a._v("，在国内是无法访问的，所以十分建议大家设置GOPROXY，这里我推荐使用"),s("a",{attrs:{href:"https://studygolang.com/topics/10014",target:"_blank",rel:"noopener noreferrer"}},[a._v("goproxy.cn"),s("OutboundLink")],1),a._v("。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("go "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("env")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOPROXY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("https://goproxy.cn,direct\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"go-mod命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod命令"}},[a._v("#")]),a._v(" go mod命令")]),a._v(" "),s("p",[a._v("常用的"),s("code",[a._v("go mod")]),a._v("命令如下：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("go mod download    下载依赖的module到本地cache（默认为$GOPATH/pkg/mod目录）\ngo mod edit        编辑go.mod文件\ngo mod graph       打印模块依赖图\ngo mod init        初始化当前文件夹, 创建go.mod文件\ngo mod tidy        增加缺少的module，删除无用的module\ngo mod vendor      将依赖复制到vendor下\ngo mod verify      校验依赖\ngo mod why         解释为什么需要依赖\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("h3",{attrs:{id:"go-mod"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod"}},[a._v("#")]),a._v(" go.mod")]),a._v(" "),s("p",[a._v("go.mod文件记录了项目所有的依赖信息，其结构大致如下：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("module github.com/Q1mi/studygo/blogger\n\ngo "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.12")]),a._v("\n\nrequire "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\tgithub.com/DeanThompson/ginpprof v0.0.0-20190408063150-3be636683586\n\tgithub.com/gin-gonic/gin v1.4.0\n\tgithub.com/go-sql-driver/mysql v1.4.1\n\tgithub.com/jmoiron/sqlx v1.2.0\n\tgithub.com/satori/go.uuid v1.2.0\n\tgoogle.golang.org/appengine v1.6.1 // indirect\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("p",[a._v("其中，")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("module")]),a._v("用来定义包名")]),a._v(" "),s("li",[s("code",[a._v("require")]),a._v("用来定义依赖包及版本")]),a._v(" "),s("li",[s("code",[a._v("indirect")]),a._v("表示间接引用")])]),a._v(" "),s("h4",{attrs:{id:"依赖的版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#依赖的版本"}},[a._v("#")]),a._v(" 依赖的版本")]),a._v(" "),s("p",[a._v("go mod支持语义化版本号，比如"),s("code",[a._v("go get foo@v1.2.3")]),a._v("，也可以跟git的分支或tag，比如"),s("code",[a._v("go get foo@master")]),a._v("，当然也可以跟git提交哈希，比如"),s("code",[a._v("go get foo@e3702bed2")]),a._v("。关于依赖的版本支持以下几种格式：")]),a._v(" "),s("div",{staticClass:"language-go line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[a._v("gopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("tomb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("v1 v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20141024135613")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("dd632973f1e7\ngopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("vmihailenco"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("msgpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("v2 v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9.1")]),a._v("\ngopkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("in"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("yaml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("v2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<=")]),a._v("v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.1")]),a._v("\ngithub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("tatsushid"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("go")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("fastping v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20160109021039")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("d7bb493dee3e\nlatest\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h4",{attrs:{id:"replace"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#replace"}},[a._v("#")]),a._v(" replace")]),a._v(" "),s("p",[a._v("在国内访问golang.org/x的各个包都需要翻墙，你可以在go.mod中使用replace替换成github上对应的库。")]),a._v(" "),s("div",{staticClass:"language-go line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[a._v("replace "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("crypto v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20180820150726")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("614d502a4dac "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("crypto v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20180820150726")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("614d502a4dac\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("net v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20180821023952")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("922f4815f713 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("net v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20180826012351")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("8a410e7b638d\n\tgolang"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("text v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("golang"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("text v0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h3",{attrs:{id:"go-get"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-get"}},[a._v("#")]),a._v(" go get")]),a._v(" "),s("p",[a._v("在项目中执行"),s("code",[a._v("go get")]),a._v("命令可以下载依赖包，并且还可以指定下载的版本。")]),a._v(" "),s("ol",[s("li",[a._v("运行"),s("code",[a._v("go get -u")]),a._v("将会升级到最新的次要版本或者修订版本(x.y.z, z是修订版本号， y是次要版本号)")]),a._v(" "),s("li",[a._v("运行"),s("code",[a._v("go get -u=patch")]),a._v("将会升级到最新的修订版本")]),a._v(" "),s("li",[a._v("运行"),s("code",[a._v("go get package@version")]),a._v("将会升级到指定的版本号version")])]),a._v(" "),s("p",[a._v("如果下载所有依赖可以使用"),s("code",[a._v("go mod download")]),a._v("命令。")]),a._v(" "),s("h3",{attrs:{id:"整理依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#整理依赖"}},[a._v("#")]),a._v(" 整理依赖")]),a._v(" "),s("p",[a._v("我们在代码中删除依赖代码后，相关的依赖库并不会在"),s("code",[a._v("go.mod")]),a._v("文件中自动移除。这种情况下我们可以使用"),s("code",[a._v("go mod tidy")]),a._v("命令更新"),s("code",[a._v("go.mod")]),a._v("中的依赖关系。")]),a._v(" "),s("h3",{attrs:{id:"go-mod-edit"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-mod-edit"}},[a._v("#")]),a._v(" go mod edit")]),a._v(" "),s("h4",{attrs:{id:"格式化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#格式化"}},[a._v("#")]),a._v(" 格式化")]),a._v(" "),s("p",[a._v("因为我们可以手动修改go.mod文件，所以有些时候需要格式化该文件。Go提供了一下命令：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("go mod edit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-fmt")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"添加依赖项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖项"}},[a._v("#")]),a._v(" 添加依赖项")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("go mod edit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-require")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("golang.org/x/text\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"移除依赖项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#移除依赖项"}},[a._v("#")]),a._v(" 移除依赖项")]),a._v(" "),s("p",[a._v("如果只是想修改"),s("code",[a._v("go.mod")]),a._v("文件中的内容，那么可以运行"),s("code",[a._v("go mod edit -droprequire=package path")]),a._v("，比如要在"),s("code",[a._v("go.mod")]),a._v("中移除"),s("code",[a._v("golang.org/x/text")]),a._v("包，可以使用如下命令：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("go mod edit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-droprequire")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("golang.org/x/text\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("关于"),s("code",[a._v("go mod edit")]),a._v("的更多用法可以通过"),s("code",[a._v("go help mod edit")]),a._v("查看。")]),a._v(" "),s("h2",{attrs:{id:"在项目中使用go-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在项目中使用go-module"}},[a._v("#")]),a._v(" 在项目中使用go module")]),a._v(" "),s("h3",{attrs:{id:"既有项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#既有项目"}},[a._v("#")]),a._v(" 既有项目")]),a._v(" "),s("p",[a._v("如果需要对一个已经存在的项目启用"),s("code",[a._v("go module")]),a._v("，可以按照以下步骤操作：")]),a._v(" "),s("ol",[s("li",[a._v("在项目目录下执行"),s("code",[a._v("go mod init")]),a._v("，生成一个"),s("code",[a._v("go.mod")]),a._v("文件。")]),a._v(" "),s("li",[a._v("执行"),s("code",[a._v("go get")]),a._v("，查找并记录当前项目的依赖，同时生成一个"),s("code",[a._v("go.sum")]),a._v("记录每个依赖库的版本和哈希值。")])]),a._v(" "),s("h3",{attrs:{id:"新项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新项目"}},[a._v("#")]),a._v(" 新项目")]),a._v(" "),s("p",[a._v("对于一个新创建的项目，我们可以在项目文件夹下按照以下步骤操作：")]),a._v(" "),s("ol",[s("li",[a._v("执行"),s("code",[a._v("go mod init 项目名")]),a._v("命令，在当前项目文件夹下创建一个"),s("code",[a._v("go.mod")]),a._v("文件。")]),a._v(" "),s("li",[a._v("手动编辑"),s("code",[a._v("go.mod")]),a._v("中的require依赖项或执行"),s("code",[a._v("go get")]),a._v("自动发现、维护依赖。")])])])}),[],!1,null,null,null);s.default=r.exports}}]);