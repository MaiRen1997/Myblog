(window.webpackJsonp=window.webpackJsonp||[]).push([[214],{666:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"深入浅出pandas-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#深入浅出pandas-2"}},[s._v("#")]),s._v(" 深入浅出pandas-2")]),s._v(" "),a("p",[s._v("如果使用 pandas 做数据分析，那么"),a("code",[s._v("DataFrame")]),s._v("一定是被使用得最多的类型，它可以用来保存和处理异质的二维数据。这里所谓的“异质”是指"),a("code",[s._v("DataFrame")]),s._v("中每个列的数据类型不需要相同，这也是它区别于 NumPy 二维数组的地方。"),a("code",[s._v("DataFrame")]),s._v("提供了极为丰富的属性和方法，帮助我们实现对数据的重塑、清洗、预处理、透视、呈现等一系列操作。")]),s._v(" "),a("h3",{attrs:{id:"创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建dataframe对象"}},[s._v("#")]),s._v(" 创建DataFrame对象")]),s._v(" "),a("h4",{attrs:{id:"通过二维数组创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过二维数组创建dataframe对象"}},[s._v("#")]),s._v(" 通过二维数组创建DataFrame对象")]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("scores "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncourses "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'语文'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数学'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'英语'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nstu_ids "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("arange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1006")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DataFrame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("scores"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" columns"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("courses"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("stu_ids"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\t\t语文\t数学\t英语\n1001    69    80\t79\n1002    71\t  60\t100\n1003    94    81\t93\n1004    88\t  88\t67\n1005    82\t  66    60\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"通过字典创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过字典创建dataframe对象"}},[s._v("#")]),s._v(" 通过字典创建DataFrame对象")]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("scores "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'语文'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("72")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("93")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("93")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数学'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("66")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'英语'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("66")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("69")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nstu_ids "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" np"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("arange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1006")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DataFrame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("scores"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("stu_ids"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        语文  数学  英语\n1001    62    95    66\n1002    72    65    75\n1003    93    86    82\n1004    88    66    69\n1005    93    87    82\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"读取csv文件创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取csv文件创建dataframe对象"}},[s._v("#")]),s._v(" 读取CSV文件创建DataFrame对象")]),s._v(" "),a("p",[s._v("可以通过"),a("code",[s._v("pandas")]),s._v(" 模块的"),a("code",[s._v("read_csv")]),s._v("函数来读取 CSV 文件，"),a("code",[s._v("read_csv")]),s._v("函数的参数非常多，下面介绍几个比较重要的参数。")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("sep")]),s._v(" / "),a("code",[s._v("delimiter")]),s._v("：分隔符，默认是"),a("code",[s._v(",")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("header")]),s._v("：表头（列索引）的位置，默认值是"),a("code",[s._v("infer")]),s._v("，用第一行的内容作为表头（列索引）。")]),s._v(" "),a("li",[a("code",[s._v("index_col")]),s._v("：用作行索引（标签）的列。")]),s._v(" "),a("li",[a("code",[s._v("usecols")]),s._v("：需要加载的列，可以使用序号或者列名。")]),s._v(" "),a("li",[a("code",[s._v("true_values")]),s._v(" / "),a("code",[s._v("false_values")]),s._v("：哪些值被视为布尔值"),a("code",[s._v("True")]),s._v(" / "),a("code",[s._v("False")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("skiprows")]),s._v("：通过行号、索引或函数指定需要跳过的行。")]),s._v(" "),a("li",[a("code",[s._v("skipfooter")]),s._v("：要跳过的末尾行数。")]),s._v(" "),a("li",[a("code",[s._v("nrows")]),s._v("：需要读取的行数。")]),s._v(" "),a("li",[a("code",[s._v("na_values")]),s._v("：哪些值被视为空值。")]),s._v(" "),a("li",[a("code",[s._v("iterator")]),s._v("：设置为"),a("code",[s._v("True")]),s._v("，函数返回迭代器对象。")]),s._v(" "),a("li",[a("code",[s._v("chunksize")]),s._v("：配合上面的参数，设置每次迭代获取的数据体量。")])]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("df3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_csv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data/2018年北京积分落户数据.csv'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("提示")]),s._v("：上面代码中的CSV文件是用相对路径进行获取的，也就是说当前工作路径下有名为"),a("code",[s._v("data")]),s._v("的文件夹，而“2018年北京积分落户数据.csv”就在这个文件夹下。如果使用Windows系统，在写路径分隔符时也建议使用"),a("code",[s._v("/")]),s._v("而不是"),a("code",[s._v("\\")]),s._v("，如果想使用"),a("code",[s._v("\\")]),s._v("，建议在字符串前面添加一个"),a("code",[s._v("r")]),s._v("，使用原始字符串来避开转义字符，例如"),a("code",[s._v("r'c:\\new\\data\\2018年北京积分落户数据.csv'")]),s._v("。")])]),s._v(" "),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("      name   birthday      company          score\nid                                             \n1     杨xx   1972-12       北京利德华福xxxx  122.59\n2     纪xx   1974-12       北京航天数据xxxx  121.25\n3     王x    1974-05       品牌联盟(北京)xx  118.96\n4     杨x    1975-07       中科专利商标xxxx  118.21\n5     张xx   1974-11       北京阿里巴巴xxxx  117.79\n...   ...      ...                  ...     ...\n6015  孙xx   1978-08       华为海洋网络xxxx   90.75\n6016  刘xx   1976-11       福斯（上海）xxxx   90.75\n6017  周x    1977-10       赢创德固赛xxxxxx   90.75\n6018  赵x    1979-07       澳科利耳医疗xxxx   90.75\n6019  贺x    1981-06       北京宝洁技术xxxx   90.75\n\n[6019 rows x 4 columns]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("说明")]),s._v("： 上面输出的内容隐去了姓名（name）和公司名称（company）字段中的部分信息。如果需要上面例子中的 CSV 文件，可以通过百度云盘获取，链接："),a("a",{attrs:{href:"https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g"),a("OutboundLink")],1),s._v("，提取码：e7b4。")])]),s._v(" "),a("h4",{attrs:{id:"读取excel工作表创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取excel工作表创建dataframe对象"}},[s._v("#")]),s._v(" 读取Excel工作表创建DataFrame对象")]),s._v(" "),a("p",[s._v("可以通过"),a("code",[s._v("pandas")]),s._v(" 模块的"),a("code",[s._v("read_excel")]),s._v("函数来读取 Excel 文件，该函数与上面的"),a("code",[s._v("read_csv")]),s._v("非常类似，多了一个"),a("code",[s._v("sheet_name")]),s._v("参数来指定数据表的名称，但是不同于 CSV 文件，没有"),a("code",[s._v("sep")]),s._v("或"),a("code",[s._v("delimiter")]),s._v("这样的参数。假设有名为“2022年股票数据.xlsx”的 Excel 文件，里面有用股票代码命名的五个表单，分别是阿里巴巴（BABA）、百度（BIDU）、京东（JD）、亚马逊（AMZN）、甲骨文（ORCL）这五个公司2022年的股票数据，如果想加载亚马逊的股票数据，代码如下所示。")]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("df4 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_excel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data/2022年股票数据.xlsx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sheet_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'AMZN'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Date'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf4\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("说明")]),s._v("：上面例子中的 CSV 文件可以通过百度云盘获取，链接："),a("a",{attrs:{href:"https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g"),a("OutboundLink")],1),s._v("，提取码：e7b4。")])]),s._v(" "),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("               Open     High       Low    Close    Volume\nDate                                                     \n2022-12-30   83.120   84.050   82.4700   84.000  62401194\n2022-12-29   82.870   84.550   82.5500   84.180  54995895\n2022-12-28   82.800   83.480   81.6900   81.820  58228575\n2022-12-27   84.970   85.350   83.0000   83.040  57284035\n2022-12-23   83.250   85.780   82.9344   85.250  57433655\n...             ...      ...       ...      ...       ...\n2022-01-07  163.839  165.243  162.0310  162.554  46605900\n2022-01-06  163.450  164.800  161.9370  163.254  51957780\n2022-01-05  166.883  167.126  164.3570  164.357  64302720\n2022-01-04  170.438  171.400  166.3490  167.522  70725160\n2022-01-03  167.550  170.704  166.1600  170.404  63869140\n\n[251 rows x 5 columns]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"读取关系数据库二维表创建dataframe对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取关系数据库二维表创建dataframe对象"}},[s._v("#")]),s._v(" 读取关系数据库二维表创建DataFrame对象")]),s._v(" "),a("p",[a("code",[s._v("pandas")]),s._v("模块的"),a("code",[s._v("read_sql")]),s._v("函数可以通过 SQL 语句从数据库中读取数据创建"),a("code",[s._v("DataFrame")]),s._v("对象，该函数的第二个参数代表了需要连接的数据库。对于 MySQL 数据库，我们可以通过"),a("code",[s._v("pymysql")]),s._v("或"),a("code",[s._v("mysqlclient")]),s._v("来创建数据库连接（需要提前安装好三方库），得到一个"),a("code",[s._v("Connection")]),s._v(" 对象，而这个对象就是"),a("code",[s._v("read_sql")]),s._v("函数需要的第二个参数，代码如下所示。")]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" pymysql\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个MySQL数据库的连接对象")]),s._v("\nconn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pymysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'101.42.16.8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'guest'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Guest.618'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    database"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hrs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" charset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf8mb4'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过SQL从数据库二维表读取数据创建DataFrame")]),s._v("\ndf5 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select * from tb_emp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'eno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("提示")]),s._v("：执行上面的代码需要先安装"),a("code",[s._v("pymysql")]),s._v("库，如果尚未安装，可以先在单元格中先执行魔法指令"),a("code",[s._v("%pip install pymysql")]),s._v("，然后再运行上面的代码。上面的代码连接的是我部署在腾讯云上的 MySQL 数据库，公网 IP 地址："),a("code",[s._v("101.42.16.8")]),s._v("，用户名："),a("code",[s._v("guest")]),s._v("，密码："),a("code",[s._v("Guest.618")]),s._v("，数据库："),a("code",[s._v("hrs")]),s._v("，字符集："),a("code",[s._v("utf8mb4")]),s._v("，大家可以使用这个数据库，但是不要进行恶意的访问。"),a("code",[s._v("hrs")]),s._v("数据库一共有三张表，分别是："),a("code",[s._v("tb_dept")]),s._v("（部门表）、"),a("code",[s._v("tb_emp")]),s._v("（员工表）、"),a("code",[s._v("tb_emp2")]),s._v("（员工表2）。")])]),s._v(" "),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("       ename   job     mgr     sal    comm    dno\neno                                        \n1359   胡一刀   销售员  3344.0  1800   200.0   30\n2056    乔峰   分析师   7800.0  5000  1500.0   20\n3088   李莫愁   设计师  2056.0  3500   800.0   20\n3211   张无忌   程序员  2056.0  3200     NaN   20\n3233   丘处机   程序员  2056.0  3400     NaN   20\n3244   欧阳锋   程序员  3088.0  3200     NaN   20\n3251   张翠山   程序员  2056.0  4000     NaN   20\n3344    黄蓉  销售主管  7800.0  3000   800.0   30\n3577    杨过    会计    5566.0  2200     NaN   10\n3588   朱九真    会计   5566.0  2500     NaN   10\n4466   苗人凤   销售员  3344.0  2500     NaN   30\n5234    郭靖    出纳    5566.0  2000     NaN   10\n5566   宋远桥   会计师  7800.0  4000  1000.0   10\n7800   张三丰    总裁     NaN   9000  1200.0   20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("执行上面的代码会出现一个警告，因为 pandas 库希望我们使用"),a("code",[s._v("SQLAlchemy")]),s._v("三方库接入数据库，具体内容是：“UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.”。如果不想看到这个警告，我们可以试一试下面的解决方案。")]),s._v(" "),a("p",[s._v("首先，安装三方库"),a("code",[s._v("SQLAlchemy")]),s._v("，在 Jupyter 中可以使用"),a("code",[s._v("%pip")]),s._v("魔法指令。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("pip install sqlalchemy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("通过"),a("code",[s._v("SQLAlchemy")]),s._v("的"),a("code",[s._v("create_engine")]),s._v("函数创建"),a("code",[s._v("Engine")]),s._v("对象作为"),a("code",[s._v("read_sql")]),s._v("函数的第二个参数，此时"),a("code",[s._v("read_sql")]),s._v("函数的第一个参数可以是 SQL 语句，也可以是二维表的表名。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sqlalchemy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" create_engine\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过指定的URL（统一资源定位符）访问数据库")]),s._v("\nengine "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" create_engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接通过表名加载整张表的数据")]),s._v("\ndf5 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tb_emp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'eno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("说明")]),s._v("：如果通过表名加载二维表数据，也可以将上面的函数换成"),a("code",[s._v("read_sql_table")]),s._v("。")])]),s._v(" "),a("p",[s._v("我们再来加载部门表的数据创建"),a("code",[s._v("DataFrame")]),s._v("对象。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("df6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select dno, dname, dloc from tb_dept'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndf6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("说明")]),s._v("：如果通过 SQL 查询获取数据，也可以将上面的函数换成"),a("code",[s._v("read_sql_query")]),s._v("。")])]),s._v(" "),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("      dname   dloc\ndno           \n10    会计部   北京\n20    研发部   成都\n30    销售部   重庆\n40    运维部   深圳\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("在完成数据加载后，如果希望释放数据库连接，可以使用下面的代码。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"基本属性和方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本属性和方法"}},[s._v("#")]),s._v(" 基本属性和方法")]),s._v(" "),a("p",[s._v("在开始讲解"),a("code",[s._v("DataFrame")]),s._v("的属性和方法前，我们先从之前提到的"),a("code",[s._v("hrs")]),s._v("数据库中读取三张表的数据，创建出三个"),a("code",[s._v("DataFrame")]),s._v("对象，完整的代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sqlalchemy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" create_engine\n\nengine "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" create_engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndept_df "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tb_dept'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nemp_df "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tb_emp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'eno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nemp2_df "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read_sql_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tb_emp2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" index_col"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'eno'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("得到的三个"),a("code",[s._v("DataFrame")]),s._v("对象如下所示。")]),s._v(" "),a("p",[s._v("部门表（"),a("code",[s._v("dept_df")]),s._v("），其中"),a("code",[s._v("dno")]),s._v("是部门的编号，"),a("code",[s._v("dname")]),s._v("和"),a("code",[s._v("dloc")]),s._v("分别是部门的名称和所在地。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    dname  dloc\ndno\n10\t会计部\t北京\n20\t研发部\t成都\n30\t销售部\t重庆\n40\t运维部\t深圳\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("员工表（"),a("code",[s._v("emp_df")]),s._v("），其中"),a("code",[s._v("eno")]),s._v("是员工编号，"),a("code",[s._v("ename")]),s._v("、"),a("code",[s._v("job")]),s._v("、"),a("code",[s._v("mgr")]),s._v("、"),a("code",[s._v("sal")]),s._v("、"),a("code",[s._v("comm")]),s._v("和"),a("code",[s._v("dno")]),s._v("分别代表员工的姓名、职位、主管编号、月薪、补贴和部门编号。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        ename    job        mgr      sal     comm    dno\neno\n1359\t胡一刀    销售员\t   3344.0\t1800\t200.0\t30\n2056\t乔峰\t    分析师\t    7800.0\t 5000\t 1500.0\t 20\n3088\t李莫愁\t   设计师\t   2056.0\t3500\t800.0\t20\n3211\t张无忌\t   程序员\t   2056.0\t3200\tNaN     20\n3233\t丘处机\t   程序员\t   2056.0\t3400\tNaN\t    20\n3244\t欧阳锋\t   程序员\t   3088.0\t3200\tNaN     20\n3251\t张翠山\t   程序员\t   2056.0\t4000\tNaN\t    20\n3344\t黄蓉\t    销售主管   7800.0\t3000\t800.0\t30\n3577\t杨过\t    会计\t     5566.0\t  2200\t  NaN\t  10\n3588\t朱九真\t   会计\t    5566.0\t 2500\t NaN\t 10\n4466\t苗人凤\t   销售员\t   3344.0\t2500\tNaN\t    30\n5234\t郭靖\t    出纳\t     5566.0\t  2000\t  NaN\t  10\n5566\t宋远桥\t   会计师\t   7800.0\t4000\t1000.0\t10\n7800\t张三丰\t   总裁\t    NaN      9000\t 1200.0\t 20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("blockquote",[a("p",[a("strong",[s._v("说明")]),s._v("：在数据库中"),a("code",[s._v("mgr")]),s._v("和"),a("code",[s._v("comm")]),s._v("两个列的数据类型是"),a("code",[s._v("int")]),s._v("，但是因为有缺失值（空值），读取到"),a("code",[s._v("DataFrame")]),s._v("之后，列的数据类型变成了"),a("code",[s._v("float")]),s._v("，因为我们通常会用"),a("code",[s._v("float")]),s._v("类型的"),a("code",[s._v("NaN")]),s._v("来表示空值。")])]),s._v(" "),a("p",[s._v("员工表（"),a("code",[s._v("emp2_df")]),s._v("），跟上面的员工表结构相同，但是保存了不同的员工数据。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("       ename    job      mgr      sal    comm    dno\neno                                      \n9500   张三丰   总裁      NaN      50000  8000    20\n9600   王大锤   程序员    9800.0   8000   600     20\n9700   张三丰   总裁      NaN      60000  6000    20\n9800   骆昊     架构师    7800.0   30000  5000    20\n9900   陈小刀   分析师    9800.0   10000  1200    20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("code",[s._v("DataFrame")]),s._v("对象的属性如下表所示。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("属性名")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("at")]),s._v(" / "),a("code",[s._v("iat")])]),s._v(" "),a("td",[s._v("通过标签获取"),a("code",[s._v("DataFrame")]),s._v("中的单个值。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("columns")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象列的索引")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("dtypes")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象每一列的数据类型")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("empty")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象是否为空")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("loc")]),s._v(" / "),a("code",[s._v("iloc")])]),s._v(" "),a("td",[s._v("通过标签获取"),a("code",[s._v("DataFrame")]),s._v("中的一组值。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("ndim")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象的维度")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("shape")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象的形状（行数和列数）")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("size")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象中元素的个数")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("values")])]),s._v(" "),a("td",[a("code",[s._v("DataFrame")]),s._v("对象的数据对应的二维数组")])])])]),s._v(" "),a("p",[s._v("关于"),a("code",[s._v("DataFrame")]),s._v("的方法，首先需要了解的是"),a("code",[s._v("info()")]),s._v("方法，它可以帮助我们了解"),a("code",[s._v("DataFrame")]),s._v("的相关信息，如下所示。")]),s._v(" "),a("p",[s._v("代码：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<class 'pandas.core.frame.DataFrame'>\nInt64Index: 14 entries, 1359 to 7800\nData columns (total 6 columns):\n #   Column  Non-Null Count  Dtype  \n---  ------  --------------  -----  \n 0   ename   14 non-null     object \n 1   job     14 non-null     object \n 2   mgr     13 non-null     float64\n 3   sal     14 non-null     int64  \n 4   comm    6 non-null      float64\n 5   dno     14 non-null     int64  \ndtypes: float64(2), int64(2), object(2)\nmemory usage: 1.3+ KB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("如果需要查看"),a("code",[s._v("DataFrame")]),s._v("的头部或尾部的数据，可以使用"),a("code",[s._v("head()")]),s._v("或"),a("code",[s._v("tail()")]),s._v("方法，这两个方法的默认参数是"),a("code",[s._v("5")]),s._v("，表示获取"),a("code",[s._v("DataFrame")]),s._v("最前面5行或最后面5行的数据，如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        ename    job    mgr    sal    comm  dno\neno\t\t\t\t\t\t\n1359\t胡一刀   销售员\t3344   1800  200   30\n2056\t乔峰\t   分析师\t 7800   5000  1500\t20\n3088\t李莫愁\t  设计师\t2056   3500  800   20\n3211\t张无忌\t  程序员\t2056   3200  NaN   20\n3233\t丘处机\t  程序员\t2056   3400\t NaN   20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"操作数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作数据"}},[s._v("#")]),s._v(" 操作数据")]),s._v(" "),a("h4",{attrs:{id:"索引和切片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引和切片"}},[s._v("#")]),s._v(" 索引和切片")]),s._v(" "),a("p",[s._v("如果要获取"),a("code",[s._v("DataFrame")]),s._v("的某一列，例如取出上面"),a("code",[s._v("emp_df")]),s._v("的"),a("code",[s._v("ename")]),s._v("列，可以使用下面的两种方式。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ename'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行上面的代码可以发现，我们获得的是一个"),a("code",[s._v("Series")]),s._v("对象。事实上，"),a("code",[s._v("DataFrame")]),s._v("对象就是将多个"),a("code",[s._v("Series")]),s._v("对象组合到一起的结果。")]),s._v(" "),a("p",[s._v("如果要获取"),a("code",[s._v("DataFrame")]),s._v("的某一行，可以使用整数索引或我们设置的索引，例如取出员工编号为"),a("code",[s._v("2056")]),s._v("的员工数据，代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iloc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("通过执行上面的代码我们发现，单独取"),a("code",[s._v("DataFrame")]),s._v(" 的某一行或某一列得到的都是"),a("code",[s._v("Series")]),s._v("对象。我们当然也可以通过花式索引来获取多个行或多个列的数据，花式索引的结果仍然是一个"),a("code",[s._v("DataFrame")]),s._v("对象。")]),s._v(" "),a("p",[s._v("获取多个列：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ename'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'job'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("获取多个行：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7800")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3344")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果要获取或修改"),a("code",[s._v("DataFrame")]),s._v(" 对象某个单元格的数据，需要同时指定行和列的索引，例如要获取员工编号为"),a("code",[s._v("2056")]),s._v("的员工的职位信息，代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'job'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'job'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'job'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("我们推荐大家使用第三种做法，因为它只做了一次索引运算。如果要将该员工的职位修改为“架构师”，可以使用下面的代码。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'job'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'架构师'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("当然，我们也可以通过切片操作来获取多行多列，相信大家一定已经想到了这一点。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2056")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3344")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        ename    job        mgr      sal     comm    dno\neno\n2056\t乔峰\t    分析师\t    7800.0\t 5000\t 1500.0\t 20\n3088\t李莫愁\t   设计师\t   2056.0\t3500\t800.0\t20\n3211\t张无忌\t   程序员\t   2056.0\t3200\tNaN     20\n3233\t丘处机\t   程序员\t   2056.0\t3400\tNaN\t    20\n3244\t欧阳锋\t   程序员\t   3088.0\t3200\tNaN     20\n3251\t张翠山\t   程序员\t   2056.0\t4000\tNaN\t    20\n3344\t黄蓉\t    销售主管   7800.0\t3000\t800.0\t30\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"数据筛选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据筛选"}},[s._v("#")]),s._v(" 数据筛选")]),s._v(" "),a("p",[s._v("上面我们提到了花式索引，相信大家已经联想到了布尔索引。跟"),a("code",[s._v("ndarray")]),s._v("和"),a("code",[s._v("Series")]),s._v("一样，我们可以通过布尔索引对"),a("code",[s._v("DataFrame")]),s._v("对象进行数据筛选，例如我们要从"),a("code",[s._v("emp_df")]),s._v("中筛选出月薪超过"),a("code",[s._v("3500")]),s._v("的员工，代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        ename    job        mgr      sal     comm    dno\neno\n2056\t乔峰\t    分析师\t    7800.0\t 5000\t 1500.0\t 20\n3251\t张翠山\t   程序员\t   2056.0\t4000\tNaN\t    20\n5566\t宋远桥\t   会计师\t   7800.0\t4000\t1000.0\t10\n7800\t张三丰\t   总裁\t    NaN      9000\t 1200.0\t 20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("当然，我们也可以组合多个条件来进行数据筛选，例如从"),a("code",[s._v("emp_df")]),s._v("中筛选出月薪超过"),a("code",[s._v("3500")]),s._v("且部门编号为"),a("code",[s._v("20")]),s._v("的员工，代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dno "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        ename    job        mgr      sal     comm    dno\neno\n2056\t乔峰\t    分析师\t    7800.0\t 5000\t 1500.0\t 20\n3251\t张翠山\t   程序员\t   2056.0\t4000\tNaN\t    20\n7800\t张三丰\t   总裁\t    NaN      9000\t 1200.0\t 20\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("除了使用布尔索引，"),a("code",[s._v("DataFrame")]),s._v("对象的"),a("code",[s._v("query")]),s._v("方法也可以实现数据筛选，"),a("code",[s._v("query")]),s._v("方法的参数是一个字符串，它代表了筛选数据使用的表达式，而且更符合 Python 程序员的使用习惯。下面我们使用"),a("code",[s._v("query")]),s._v("方法将上面的效果重新实现一遍，代码如下所示。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("emp_df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sal > 3500 and dno == 20'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);